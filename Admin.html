<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dash Edu-Tend System</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  </head>
  <body class="admin-dashboard">
    <div class="sidebar nav" id="sidebar">
      <h2 data-translate="admin-sidebar-title">Admin Dashboard</h2>
      <nav>
        <a href="#" class="lecturer-nav-item active" data-target="dashboard">
          <i class="mr-3 fas fa-tachometer-alt"></i> <span data-translate="nav-dashboard">Dashboard</span>
        </a>
        <a href="#" class="lecturer-nav-item" data-target="calendar">
          <i class="mr-3 fas fa-calendar"></i> <span data-translate="nav-calendar">Calendar</span>
        </a>
        <a href="#" class="lecturer-nav-item" data-target="users">
          <i class="mr-3 fas fa-users"></i> <span data-translate="nav-users">Users</span>
        </a>
        <a href="#" class="lecturer-nav-item" data-target="lecturers">
          <i class="mr-3 fas fa-chalkboard-teacher"></i> <span data-translate="nav-lecturers">Lecturers</span>
        </a>
        <a href="#" class="lecturer-nav-item" data-target="students">
          <i class="mr-3 fas fa-user-graduate"></i> <span data-translate="nav-students">Students</span>
        </a>
        <a
          href="adminc.html"
          class="lecturer-nav-item block px-4 text-gray-700 hover:bg-indigo-50 hover:text-indigo600 rounded"
          data-target="courses"
        >
          <i class="mr-3 fas fa-book"></i> <span data-translate="nav-courses">Courses</span>
        </a>
        <a href="#" class="lecturer-nav-item" data-target="attendance">
          <i class="mr-3 fas fa-check"></i> <span data-translate="nav-attendance">Attendance</span>
        </a>
        <a href="#" class="lecturer-nav-item" data-target="settings">
          <i class="mr-3 fas fa-cog"></i> <span data-translate="nav-settings">Settings</span>
        </a>
        <a href="index.html" class="lecturer-nav-item" data-target="logout">
          <i class="mr-3 fas fa-sign-out-alt"></i> <span data-translate="nav-logout">Logout</span>
        </a>
      </nav>
    </div>

    <div class="main-content">
      <header class="header">

        <div class="toggle">
          <button id="sidebar-toggle" class="toggle-btn" aria-label="Open Menu">
            <i class="fas fa-bars"></i>
          </button>
        </div>
        

        <div class="sidebar2" id="sidebar2">
          <div class="sidebar-header">
            <div class="sidebar-title">
              <h2 class="h1">Admin Dashboard</h2>
              <p class="h2">EdUTEND System</p>
            </div>
            <button id="sidebar-close" class="sidebar-close-btn" aria-label="Close Menu">
              <i class="fas fa-times"></i>
            </button>
          </div>
          
          <nav class="mobile-nav">
            <a href="#" class="lecturer-nav-item active" data-target="dashboard">
              <i class="fas fa-tachometer-alt"></i>
              <span>Dashboard</span>
            </a>
            <a href="#" class="lecturer-nav-item" data-target="calendar">
              <i class="fas fa-calendar"></i>
              <span>Calendar</span>
            </a>
            <a href="#" class="lecturer-nav-item" data-target="users">
              <i class="fas fa-users"></i>
              <span>Users</span>
            </a>
            <a href="#" class="lecturer-nav-item" data-target="lecturers">
              <i class="fas fa-chalkboard-teacher"></i>
              <span>Lecturers</span>
            </a>
            <a href="#" class="lecturer-nav-item" data-target="students">
              <i class="fas fa-user-graduate"></i>
              <span>Students</span>
            </a>
            <a href="adminc.html" class="lecturer-nav-item" data-target="courses">
              <i class="fas fa-book"></i>
              <span>Courses</span>
            </a>
            <a href="#" class="lecturer-nav-item" data-target="attendance">
              <i class="fas fa-check"></i>
              <span data-translate="nav-attendance">Attendance</span>
            </a>
            <a href="#" class="lecturer-nav-item" data-target="settings">
              <i class="fas fa-cog"></i>
              <span data-translate="nav-settings">Settings</span>
            </a>
            <a href="index.html" class="lecturer-nav-item logout-item" data-target="logout">
              <i class="fas fa-sign-out-alt"></i>
              <span data-translate="nav-logout">Logout</span>
            </a>
          </nav>
          

          <div class="mobile-user-info">
            <div class="user-avatar">AD</div>
            <div class="user-details">
              <p class="user-name">Admin</p>
              <p class="user-role">System Administrator</p>
            </div>
          </div>
        </div>
        

        <div class="user-info">
          <span>Welcome, Admin</span>
        </div>
        <div class="header-actions"></div>
      </header>

      <div id="dashboard" class="section">
        <h3 data-translate="admin-dashboard-title">Dashboard Overview</h3>
        <div class="stats-grid">
          <div class="stat-box" data-translate="admin-total-students">Total Students: <br /><span>0</span></div>
          <div class="stat-box" data-translate="admin-total-lecturers">Total Lecturers: <br /><span>0</span></div>
          <div class="stat-box" data-translate="admin-total-courses">Total Courses: <br /><span>0</span></div>
          <div class="stat-box" data-translate="admin-total-attendance">Total Attendance: <br /><span>0</span></div>
        </div>
      </div>

      <div id="calendar" class="section">
        <h3 data-translate="admin-calendar-title">Calendar</h3>
        <div class="calendar" id="admin-calendar">
          <div class="header">
            <div class="month" id="adm-calendar-month">Month YYYY</div>
            <div class="btns">
              <div class="btn" id="adm-calendar-prev">&#10094;</div>
              <div class="btn" id="adm-calendar-next">&#10095;</div>
            </div>
          </div>
          <div class="weekdays" id="adm-calendar-weekdays"></div>
          <div class="days" id="adm-calendar-days"></div>
        </div>

        <div class="settings-group mt-16">
          <h4 data-translate="admin-event-controls">Event Controls</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="adm-filter-type" data-translate="admin-filter-type">Type</label>
              <select id="adm-filter-type">
                <option value="all" data-translate="admin-filter-all">All</option>
                <option value="Lecture" data-translate="admin-filter-lecture">Lecture</option>
                <option value="Exam" data-translate="admin-filter-exam">Exam</option>
                <option value="Meeting" data-translate="admin-filter-meeting">Meeting</option>
                <option value="Other" data-translate="admin-filter-other">Other</option>
              </select>
            </div>
            <div class="form-field">
              <label for="adm-filter-course" data-translate="admin-filter-course">Course</label>
              <input type="text" id="adm-filter-course" placeholder="e.g., HCI-201" data-translate-placeholder="admin-filter-course-placeholder" />
            </div>
            <div class="form-field">
              <label for="adm-filter-search" data-translate="admin-filter-search">Search</label>
              <input type="text" id="adm-filter-search" placeholder="Search title/notes" data-translate-placeholder="admin-filter-search-placeholder" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="adm-filter-apply" type="button" data-translate="admin-apply-filters">Apply Filters</button>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-add-edit-event">Add / Edit Event <span id="adm-selected-date-label" class="muted"></span></h4>
          <div class="form-grid">
            <input type="hidden" id="adm-event-id" />
            <div class="form-field">
              <label for="adm-event-title" data-translate="admin-event-title">Title</label>
              <input type="text" id="adm-event-title" placeholder="Event title" data-translate-placeholder="admin-event-title-placeholder" />
            </div>
            <div class="form-field">
              <label for="adm-event-time" data-translate="admin-event-time">Time</label>
              <input type="time" id="adm-event-time" />
            </div>
            <div class="form-field">
              <label for="adm-event-type" data-translate="admin-event-type">Type</label>
              <select id="adm-event-type">
                <option value="Lecture" data-translate="admin-event-lecture">Lecture</option>
                <option value="Exam" data-translate="admin-event-exam">Exam</option>
                <option value="Meeting" data-translate="admin-event-meeting">Meeting</option>
                <option value="Other" data-translate="admin-event-other">Other</option>
              </select>
            </div>
            <div class="form-field">
              <label for="adm-event-course" data-translate="admin-event-course">Course</label>
              <input type="text" id="adm-event-course" placeholder="e.g., HCI-201" data-translate-placeholder="admin-event-course-placeholder" />
            </div>
            <div class="form-field">
              <label for="adm-event-lecturer" data-translate="admin-event-lecturer">Lecturer</label>
              <input type="text" id="adm-event-lecturer" placeholder="e.g., Dr Zinhle" data-translate-placeholder="admin-event-lecturer-placeholder" />
            </div>
            <div class="form-field full-width">
              <label for="adm-event-notes" data-translate="admin-event-notes">Notes</label>
              <textarea id="adm-event-notes" rows="2" placeholder="Additional details..." data-translate-placeholder="admin-event-notes-placeholder"></textarea>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="adm-event-save" type="button" data-translate="admin-save">Save</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="adm-event-reset" type="button" data-translate="admin-reset">Reset</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="adm-event-delete" type="button" data-translate="admin-delete">Delete</button>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-events-for">Events for <span id="adm-events-date" data-translate="admin-select-date">Select a date</span></h4>
          <ul id="adm-events-list"></ul>
        </div>

        <div class="report-actions">
          <button class="btn" id="adm-export-json"><i class="fa fa-file-export"></i> <span data-translate="admin-export-json">Export JSON</span></button>
          <button class="btn" id="adm-import-json"><i class="fa fa-file-import"></i> <span data-translate="admin-import-json">Import JSON</span></button>
          <input type="file" id="adm-import-file" accept="application/json" style="display:none" />
          <button class="btn" id="adm-clear-all"><i class="fa fa-trash"></i> <span data-translate="admin-clear-all">Clear All</span></button>
          <button class="btn" id="adm-print"><i class="fa fa-print"></i> <span data-translate="admin-print">Print</span></button>
        </div>
      </div>

      <div id="users" class="section">
        <h3 data-translate="admin-users-title">Users</h3>
        <div class="attendance-toolbar">
          <div class="form-grid">
            <div class="form-field">
              <label for="user-filter-role" data-translate="admin-user-role">Role</label>
              <select id="user-filter-role">
                <option value="all" data-translate="admin-filter-all">All</option>
                <option value="Admin" data-translate="admin-role-admin">Admin</option>
                <option value="Lecturer" data-translate="admin-role-lecturer">Lecturer</option>
                <option value="Student" data-translate="admin-role-student">Student</option>
              </select>
            </div>
            <div class="form-field">
              <label for="user-filter-search" data-translate="admin-user-search">Search</label>
              <input type="text" id="user-filter-search" placeholder="Name or Email" data-translate-placeholder="admin-user-search-placeholder" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="user-filter-apply" type="button" data-translate="admin-apply">Apply</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="user-export" type="button" data-translate="admin-export-json">Export JSON</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="user-import" type="button" data-translate="admin-import-json">Import JSON</button>
              <input type="file" id="user-import-file" accept="application/json" style="display:none" />
            </div>
          </div>
        </div>

        <div class="table-responsive">
          <table class="attendance-table users-table">
            <thead>
              <tr>
                <th data-translate="admin-user-name">Name</th>
                <th data-translate="admin-user-email">Email</th>
                <th data-translate="admin-user-role">Role</th>
                <th data-translate="admin-user-actions">Actions</th>
              </tr>
            </thead>
            <tbody id="users-tbody">
              <tr><td colspan="4" class="centered-cell" data-translate="admin-no-users-found">No users found.</td></tr>
            </tbody>
          </table>
        </div>

        <div class="settings-group mt-16">
          <h4 data-translate="admin-add-edit-user">Add / Edit User</h4>
          <div class="form-grid">
            <input type="hidden" id="user-id" />
            <div class="form-field">
              <label for="user-name" data-translate="admin-user-full-name">Full Name</label>
              <input type="text" id="user-name" placeholder="e.g., Bukho Skweza" data-translate-placeholder="admin-user-name-placeholder" />
            </div>
            <div class="form-field">
              <label for="user-email" data-translate="admin-user-email">Email</label>
              <input type="email" id="user-email" placeholder="name@example.com" data-translate-placeholder="admin-user-email-placeholder" />
            </div>
            <div class="form-field">
              <label for="user-password" data-translate="admin-user-password">Password</label>
              <input type="password" id="user-password" placeholder="Set or change password" data-translate-placeholder="admin-user-password-placeholder" />
            </div>
            <div class="form-field">
              <label for="user-role" data-translate="admin-user-role">Role</label>
              <select id="user-role">
                <option value="Admin" data-translate="admin-role-admin">Admin</option>
                <option value="Lecturer" data-translate="admin-role-lecturer">Lecturer</option>
                <option value="Student" data-translate="admin-role-student">Student</option>
              </select>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="user-save" type="button" data-translate="admin-save">Save</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="user-reset" type="button" data-translate="admin-reset">Reset</button>
            </div>
          </div>
        </div>
      </div>

      <div id="lecturers" class="section">
        <h3 data-translate="admin-lecturers-title">Lecturers</h3>
        <div class="attendance-toolbar">
          <div class="form-grid">
            <div class="form-field">
              <label for="lecturer-filter-dept" data-translate="admin-lecturer-department">Department</label>
              <select id="lecturer-filter-dept">
                <option value="all" data-translate="admin-all-departments">All Departments</option>
                <option value="Computer Science" data-translate="admin-dept-computer-science">Computer Science</option>
                <option value="Mathematics" data-translate="admin-dept-mathematics">Mathematics</option>
                <option value="Physics" data-translate="admin-dept-physics">Physics</option>
                <option value="Engineering" data-translate="admin-dept-engineering">Engineering</option>
              </select>
            </div>
            <div class="form-field">
              <label for="lecturer-filter-search" data-translate="admin-lecturer-search">Search</label>
              <input type="text" id="lecturer-filter-search" placeholder="Name or Email" data-translate-placeholder="admin-lecturer-search-placeholder" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="lecturer-filter-apply" type="button" data-translate="admin-apply">Apply</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="lecturer-export" type="button" data-translate="admin-export-json">Export JSON</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="lecturer-import" type="button" data-translate="admin-import-json">Import JSON</button>
              <input type="file" id="lecturer-import-file" accept="application/json" style="display:none" />
            </div>
          </div>
        </div>

        <div class="table-responsive">
          <table class="attendance-table lecturers-table">
            <thead>
              <tr>
                <th data-translate="admin-lecturer-name">Name</th>
                <th data-translate="admin-lecturer-email">Email</th>
                <th data-translate="admin-lecturer-department">Department</th>
                <th data-translate="admin-lecturer-office">Office</th>
                <th data-translate="admin-lecturer-phone">Phone</th>
                <th data-translate="admin-lecturer-actions">Actions</th>
              </tr>
            </thead>
            <tbody id="lecturers-tbody">
              <tr><td colspan="6" class="centered-cell" data-translate="admin-no-lecturers-found">No lecturers found.</td></tr>
            </tbody>
          </table>
        </div>

        <div class="settings-group mt-16">
          <h4 data-translate="admin-add-edit-lecturer">Add / Edit Lecturer</h4>
          <div class="form-grid">
            <input type="hidden" id="lecturer-id" />
            <div class="form-field">
              <label for="lecturer-name" data-translate="admin-lecturer-full-name">Full Name</label>
              <input type="text" id="lecturer-name" placeholder="e.g., Dr. Soetsang" data-translate-placeholder="admin-lecturer-name-placeholder" />
            </div>
            <div class="form-field">
              <label for="lecturer-email" data-translate="admin-lecturer-email">Email</label>
              <input type="email" id="lecturer-email" placeholder="name@example.com" data-translate-placeholder="admin-lecturer-email-placeholder" />
            </div>
            <div class="form-field">
              <label for="lecturer-password" data-translate="admin-lecturer-password">Password</label>
              <input type="password" id="lecturer-password" placeholder="Set or change password" data-translate-placeholder="admin-lecturer-password-placeholder" />
            </div>
            <div class="form-field">
              <label for="lecturer-dept" data-translate="admin-lecturer-department">Department</label>
              <select id="lecturer-dept">
                <option value="Computer Science" data-translate="admin-dept-computer-science">Computer Science</option>
                <option value="Mathematics" data-translate="admin-dept-mathematics">Mathematics</option>
                <option value="Physics" data-translate="admin-dept-physics">Physics</option>
                <option value="Engineering" data-translate="admin-dept-engineering">Engineering</option>
              </select>
            </div>
            <div class="form-field">
              <label for="lecturer-office" data-translate="admin-lecturer-office">Office</label>
              <input type="text" id="lecturer-office" placeholder="e.g., Block B, Room 214" data-translate-placeholder="admin-lecturer-office-placeholder" />
            </div>
            <div class="form-field">
              <label for="lecturer-phone" data-translate="admin-lecturer-phone">Phone</label>
              <input type="tel" id="lecturer-phone" placeholder="e.g., +27 82 123 4567" data-translate-placeholder="admin-lecturer-phone-placeholder" />
            </div>
            <div class="form-field full-width">
              <label for="lecturer-bio" data-translate="admin-lecturer-biography">Biography</label>
              <textarea id="lecturer-bio" rows="3" placeholder="Short bio..." data-translate-placeholder="admin-lecturer-bio-placeholder"></textarea>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="lecturer-save" type="button" data-translate="admin-save">Save</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="lecturer-reset" type="button" data-translate="admin-reset">Reset</button>
            </div>
          </div>
        </div>
      </div>

      <div id="students" class="section">
        <h3 data-translate="admin-students-title">Students</h3>
        <div class="attendance-toolbar">
          <div class="form-grid">
            <div class="form-field">
              <label for="student-filter-year" data-translate="admin-student-year">Year</label>
              <select id="student-filter-year">
                <option value="all" data-translate="admin-all-years">All Years</option>
                <option value="1" data-translate="admin-year-1">1st Year</option>
                <option value="2" data-translate="admin-year-2">2nd Year</option>
                <option value="3" data-translate="admin-year-3">3rd Year</option>
                <option value="4" data-translate="admin-year-4">4th Year</option>
              </select>
            </div>
            <div class="form-field">
              <label for="student-filter-course" data-translate="admin-student-course">Course</label>
              <input type="text" id="student-filter-course" placeholder="e.g., HCI-201" data-translate-placeholder="admin-student-course-placeholder" />
            </div>
            <div class="form-field">
              <label for="student-filter-search" data-translate="admin-student-search">Search</label>
              <input type="text" id="student-filter-search" placeholder="Name or Email" data-translate-placeholder="admin-student-search-placeholder" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="student-filter-apply" type="button" data-translate="admin-apply">Apply</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="student-export" type="button" data-translate="admin-export-json">Export JSON</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="student-import" type="button" data-translate="admin-import-json">Import JSON</button>
              <input type="file" id="student-import-file" accept="application/json" style="display:none" />
            </div>
          </div>
        </div>

        <div class="table-responsive">
          <table class="attendance-table students-table">
            <thead>
              <tr>
                <th data-translate="admin-student-name">Name</th>
                <th data-translate="admin-student-email">Email</th>
                <th data-translate="admin-student-year">Year</th>
                <th data-translate="admin-student-course">Course</th>
                <th data-translate="admin-student-id">Student ID</th>
                <th data-translate="admin-student-actions">Actions</th>
              </tr>
            </thead>
            <tbody id="students-tbody">
              <tr><td colspan="6" class="centered-cell" data-translate="admin-no-students-found">No students found.</td></tr>
            </tbody>
          </table>
        </div>

        <div class="settings-group mt-16">
          <h4 data-translate="admin-add-edit-student">Add / Edit Student</h4>
          <div class="form-grid">
            <input type="hidden" id="student-id" />
            <div class="form-field">
              <label for="student-name" data-translate="admin-student-full-name">Full Name</label>
              <input type="text" id="student-name" placeholder="e.g., Bukho Skweza" data-translate-placeholder="admin-student-name-placeholder" />
            </div>
            <div class="form-field">
              <label for="student-email" data-translate="admin-student-email">Email</label>
              <input type="email" id="student-email" placeholder="name@example.com" data-translate-placeholder="admin-student-email-placeholder" />
            </div>
            <div class="form-field">
              <label for="student-password" data-translate="admin-student-password">Password</label>
              <input type="password" id="student-password" placeholder="Set or change password" data-translate-placeholder="admin-student-password-placeholder" />
            </div>
            <div class="form-field">
              <label for="student-year" data-translate="admin-student-year">Year</label>
              <select id="student-year">
                <option value="1" data-translate="admin-year-1">1st Year</option>
                <option value="2" data-translate="admin-year-2">2nd Year</option>
                <option value="3" data-translate="admin-year-3">3rd Year</option>
                <option value="4" data-translate="admin-year-4">4th Year</option>
              </select>
            </div>
            <div class="form-field">
              <label for="student-course" data-translate="admin-student-course">Course</label>
              <input type="text" id="student-course" placeholder="e.g., HCI-201" data-translate-placeholder="admin-student-course-placeholder" />
            </div>
            <div class="form-field">
              <label for="student-id-num" data-translate="admin-student-id">Student ID</label>
              <input type="text" id="student-id-num" placeholder="e.g., 2024001" data-translate-placeholder="admin-student-id-placeholder" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="student-save" type="button" data-translate="admin-save">Save</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="student-reset" type="button" data-translate="admin-reset">Reset</button>
            </div>
          </div>
        </div>
      </div>

          <div id="attendance" class="section">
        <h3 data-translate="admin-attendance-overview">Attendance Overview</h3>
        <div class="attendance-toolbar">
          <div class="form-grid">
            <div class="form-field">
              <label for="att-filter-date-from" data-translate="admin-attendance-from">From</label>
              <input type="date" id="att-filter-date-from" />
            </div>
            <div class="form-field">
              <label for="att-filter-date-to" data-translate="admin-attendance-to">To</label>
              <input type="date" id="att-filter-date-to" />
            </div>
            <div class="form-field">
              <label for="att-filter-course" data-translate="admin-attendance-course">Course</label>
              <select id="att-filter-course">
                <option value="all" data-translate="admin-all-courses">All Courses</option>
              </select>
            </div>
            <div class="form-field">
              <label for="att-filter-lecturer" data-translate="admin-attendance-lecturer">Lecturer</label>
              <select id="att-filter-lecturer">
                <option value="all" data-translate="admin-all-lecturers">All Lecturers</option>
              </select>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="att-filter-apply" type="button" data-translate="admin-apply-filters">Apply Filters</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="att-export" type="button" data-translate="admin-export-report">Export Report</button>
            </div>
          </div>
        </div>

        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-icon">üìä</div>
            <div class="stat-content">
              <div class="stat-label" data-translate="admin-total-sessions">Total Sessions</div>
              <div class="stat-value" id="total-sessions">0</div>
            </div>
          </div>
          <div class="stat-box">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-content">
              <div class="stat-label" data-translate="admin-present-students">Present Students</div>
              <div class="stat-value" id="present-students">0</div>
            </div>
          </div>
          <div class="stat-box">
            <div class="stat-icon">‚ùå</div>
            <div class="stat-content">
              <div class="stat-label" data-translate="admin-absent-students">Absent Students</div>
              <div class="stat-value" id="absent-students">0</div>
            </div>
          </div>
          <div class="stat-box">
            <div class="stat-icon">üìà</div>
            <div class="stat-content">
              <div class="stat-label" data-translate="admin-attendance-rate">Attendance Rate</div>
              <div class="stat-value" id="attendance-rate">0%</div>
            </div>
          </div>
        </div>

        <div class="table-responsive">
          <table class="attendance-table">
            <thead>
              <tr>
                <th data-translate="admin-attendance-date">Date</th>
                <th data-translate="admin-attendance-course">Course</th>
                <th data-translate="admin-attendance-lecturer">Lecturer</th>
                <th data-translate="admin-attendance-session">Session</th>
                <th data-translate="admin-attendance-present">Present</th>
                <th data-translate="admin-attendance-absent">Absent</th>
                <th data-translate="admin-attendance-rate">Rate</th>
                <th data-translate="admin-attendance-actions">Actions</th>
              </tr>
            </thead>
            <tbody id="attendance-tbody">
              <tr><td colspan="8" class="centered-cell" data-translate="admin-no-attendance-records">No attendance records found.</td></tr>
            </tbody>
          </table>
        </div>

        <div class="settings-group mt-16">
          <h4 data-translate="admin-attendance-reports">Attendance Reports</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="report-type" data-translate="admin-report-type">Report Type</label>
              <select id="report-type">
                <option value="summary" data-translate="admin-report-summary">Summary Report</option>
                <option value="detailed" data-translate="admin-report-detailed">Detailed Report</option>
                <option value="student" data-translate="admin-report-student">Student Report</option>
                <option value="course" data-translate="admin-report-course">Course Report</option>
              </select>
            </div>
            <div class="form-field">
              <label for="report-format" data-translate="admin-report-format">Format</label>
              <select id="report-format">
                <option value="pdf" data-translate="admin-format-pdf">PDF</option>
                <option value="excel" data-translate="admin-format-excel">Excel</option>
                <option value="csv" data-translate="admin-format-csv">CSV</option>
              </select>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="generate-report" type="button" data-translate="admin-generate-report">Generate Report</button>
            </div>
          </div>
        </div>
      </div>

      <div id="settings" class="section">
        <h3 data-translate="admin-settings-title">Admin Settings</h3>
        
        <div class="settings-group">
          <h4 data-translate="admin-system-preferences">System Preferences</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="default-session-duration" data-translate="admin-default-session-duration">Default Session Duration (minutes)</label>
              <input type="number" id="default-session-duration" placeholder="15" min="5" max="120" data-translate-placeholder="admin-default-session-duration-placeholder" />
            </div>
            <div class="form-field">
              <label for="attendance-threshold" data-translate="admin-attendance-threshold">Attendance Threshold (%)</label>
              <input type="number" id="attendance-threshold" placeholder="75" min="0" max="100" data-translate-placeholder="admin-attendance-threshold-placeholder" />
            </div>
            <div class="form-field">
              <label for="auto-archive-days" data-translate="admin-auto-archive-days">Auto Archive After (days)</label>
              <input type="number" id="auto-archive-days" placeholder="90" min="30" max="365" data-translate-placeholder="admin-auto-archive-days-placeholder" />
            </div>
            <div class="form-field">
              <label for="timezone" data-translate="admin-timezone">Timezone</label>
              <select id="timezone">
                <option value="Africa/Johannesburg">Africa/Johannesburg (SAST)</option>
                <option value="Africa/Cape_Town">Africa/Cape_Town (SAST)</option>
                <option value="Africa/Durban">Africa/Durban (SAST)</option>
                <option value="UTC">UTC (GMT+0)</option>
                <option value="America/New_York">America/New_York (EST/EDT)</option>
                <option value="America/Los_Angeles">America/Los_Angeles (PST/PDT)</option>
                <option value="Europe/London">Europe/London (GMT/BST)</option>
                <option value="Europe/Paris">Europe/Paris (CET/CEST)</option>
                <option value="Asia/Tokyo">Asia/Tokyo (JST)</option>
                <option value="Asia/Shanghai">Asia/Shanghai (CST)</option>
                <option value="Australia/Sydney">Australia/Sydney (AEST/AEDT)</option>
              </select>
            </div>
            <div class="form-field">
              <label for="admin-language-select" data-translate="admin-language-label">Language</label>
              <select id="admin-language-select">
                <option value="en" data-translate="language-english">English</option>
                <option value="xh" data-translate="language-xhosa">Xhosa</option>
                <option value="st" data-translate="language-sesotho">Sesotho</option>
                <option value="tn" data-translate="language-setswana">Setswana</option>
                <option value="zu" data-translate="language-zulu">Zulu</option>
              </select>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-notifications">Notifications</h4>
          <div class="form-grid">
            <div class="form-field">
              <label data-translate="admin-email-notifications">Email Notifications</label>
              <div class="checkboxes">
                <label><input type="checkbox" id="notif-low-attendance" /> <span data-translate="admin-low-attendance-alerts">Low attendance alerts</span></label>
                <label><input type="checkbox" id="notif-session-expiry" /> <span data-translate="admin-session-expiry-reminders">Session expiry reminders</span></label>
                <label><input type="checkbox" id="notif-system-updates" /> <span data-translate="admin-system-updates">System updates</span></label>
              </div>
            </div>
            <div class="form-field">
              <label for="admin-email" data-translate="admin-admin-email">Admin Email</label>
              <input type="email" id="admin-email" placeholder="admin@example.com" data-translate-placeholder="admin-admin-email-placeholder" />
            </div>
            <div class="form-field">
              <label for="notification-frequency" data-translate="admin-notification-frequency">Notification Frequency</label>
              <select id="notification-frequency">
                <option value="immediate" data-translate="admin-immediate">Immediate</option>
                <option value="daily" data-translate="admin-daily-summary">Daily Summary</option>
                <option value="weekly" data-translate="admin-weekly-summary">Weekly Summary</option>
              </select>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-security">Security</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="current-admin-password" data-translate="admin-current-password">Current Password</label>
              <input type="password" id="current-admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" data-translate-placeholder="admin-password-placeholder" />
            </div>
            <div class="form-field">
              <label for="new-admin-password" data-translate="admin-new-password">New Password</label>
              <input type="password" id="new-admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" data-translate-placeholder="admin-password-placeholder" />
            </div>
            <div class="form-field">
              <label for="confirm-admin-password" data-translate="admin-confirm-password">Confirm New Password</label>
              <input type="password" id="confirm-admin-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" data-translate-placeholder="admin-password-placeholder" />
            </div>
            <div class="form-field">
              <label for="session-timeout" data-translate="admin-session-timeout">Session Timeout (minutes)</label>
              <input type="number" id="session-timeout" placeholder="30" min="5" max="480" data-translate-placeholder="admin-session-timeout-placeholder" />
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-data-management">Data Management</h4>
          <div class="form-grid">
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="backup-data" type="button" data-translate="admin-create-backup">Create Backup</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="restore-data" type="button" data-translate="admin-restore-data">Restore Data</button>
              <input type="file" id="restore-file" accept=".json" style="display:none" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="clear-all-data" type="button" data-translate="admin-clear-all-data">Clear All Data</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="export-all" type="button" data-translate="admin-export-all-data">Export All Data</button>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-backup-recovery-management">Backup & Recovery Management</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="backup-name" data-translate="admin-backup-name">Backup Name</label>
              <input type="text" id="backup-name" placeholder="Enter backup description" data-translate-placeholder="admin-backup-name-placeholder" />
            </div>
            <div class="form-field">
              <label for="backup-type" data-translate="admin-backup-type">Backup Type</label>
              <select id="backup-type">
                <option value="full" data-translate="admin-full-system-backup">Full System Backup</option>
                <option value="users" data-translate="admin-users-only">Users Only</option>
                <option value="courses" data-translate="admin-courses-only">Courses Only</option>
                <option value="attendance" data-translate="admin-attendance-only">Attendance Only</option>
                <option value="settings" data-translate="admin-settings-only">Settings Only</option>
              </select>
            </div>
            <div class="form-field">
              <label for="backup-format" data-translate="admin-export-format">Export Format</label>
              <select id="backup-format">
                <option value="json" data-translate="admin-json-recommended">JSON (Recommended)</option>
                <option value="csv" data-translate="admin-csv">CSV</option>
                <option value="excel" data-translate="admin-excel">Excel</option>
              </select>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="create-custom-backup" type="button" data-translate="admin-create-custom-backup">Create Custom Backup</button>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-automated-backup-settings">Automated Backup Settings</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="auto-backup-enabled" data-translate="admin-enable-auto-backup">Enable Auto Backup</label>
              <div class="checkboxes">
                <label><input type="checkbox" id="auto-backup-enabled" /> <span data-translate="admin-enable-automatic-backups">Enable automatic backups</span></label>
              </div>
            </div>
            <div class="form-field">
              <label for="backup-frequency" data-translate="admin-backup-frequency">Backup Frequency</label>
              <select id="backup-frequency">
                <option value="daily" data-translate="admin-daily">Daily</option>
                <option value="weekly" data-translate="admin-weekly">Weekly</option>
                <option value="monthly" data-translate="admin-monthly">Monthly</option>
              </select>
            </div>
            <div class="form-field">
              <label for="backup-time" data-translate="admin-backup-time">Backup Time</label>
              <input type="time" id="backup-time" value="02:00" />
            </div>
            <div class="form-field">
              <label for="backup-retention" data-translate="admin-retention-period">Retention Period (days)</label>
              <input type="number" id="backup-retention" placeholder="30" min="1" max="365" data-translate-placeholder="admin-retention-period-placeholder" />
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="save-backup-settings" type="button" data-translate="admin-save-settings">Save Settings</button>
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-backup-history-management">Backup History & Management</h4>
          <div class="backup-history-container">
            <div class="backup-history-header">
              <h5 data-translate="admin-recent-backups">Recent Backups</h5>
              <button class="btn btn-small" id="refresh-backups" data-translate="admin-refresh">Refresh</button>
            </div>
            <div class="backup-list" id="backup-list">
              <!-- Backup items will be populated here -->
            </div>
          </div>
        </div>

        <div class="settings-group">
          <h4 data-translate="admin-data-recovery-options">Data Recovery Options</h4>
          <div class="form-grid">
            <div class="form-field">
              <label for="recovery-mode" data-translate="admin-recovery-mode">Recovery Mode</label>
              <select id="recovery-mode">
                <option value="merge" data-translate="admin-merge-existing-data">Merge with existing data</option>
                <option value="replace" data-translate="admin-replace-all-data">Replace all data</option>
                <option value="selective" data-translate="admin-selective-restore">Selective restore</option>
              </select>
            </div>
            <div class="form-field">
              <label for="recovery-verification" data-translate="admin-enable-verification">Enable Verification</label>
              <div class="checkboxes">
                <label><input type="checkbox" id="recovery-verification" checked /> <span data-translate="admin-verify-data-integrity">Verify data integrity before restore</span></label>
              </div>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn" id="verify-backup" type="button" data-translate="admin-verify-selected-backup">Verify Selected Backup</button>
            </div>
            <div class="form-field">
              <label>&nbsp;</label>
              <button class="btn btn-danger" id="emergency-restore" type="button" data-translate="admin-emergency-restore">Emergency Restore</button>
            </div>
          </div>
        </div>

        <div class="form-actions">
          <button class="btn" id="save-settings" type="button" data-translate="admin-save-settings">Save Settings</button>
          <button class="btn" id="reset-settings" type="button" data-translate="admin-reset-to-defaults">Reset to Defaults</button>
        </div>
      </div>
    </div>

    <script>
      // Admin Translation System
      const adminTranslations = {
        en: {
          // Navigation
          'admin-sidebar-title': 'Admin Dashboard',
          'nav-dashboard': 'Dashboard',
          'nav-calendar': 'Calendar',
          'nav-users': 'Users',
          'nav-lecturers': 'Lecturers',
          'nav-students': 'Students',
          'nav-courses': 'Courses',
          'nav-attendance': 'Attendance',
          'nav-settings': 'Settings',
          'nav-logout': 'Logout',
          
          // Dashboard
          'admin-dashboard-title': 'Dashboard Overview',
          'admin-total-students': 'Total Students:',
          'admin-total-lecturers': 'Total Lecturers:',
          'admin-total-courses': 'Total Courses:',
          'admin-total-attendance': 'Total Attendance:',
          
          // Settings
          'admin-settings-title': 'Admin Settings',
          'admin-system-preferences': 'System Preferences',
          'admin-language-label': 'Language',
          'language-english': 'English',
          'language-xhosa': 'Xhosa',
          'language-sesotho': 'Sesotho',
          'language-setswana': 'Setswana',
          'language-zulu': 'Zulu',
          
          // Calendar
          'admin-calendar-title': 'Calendar',
          'admin-event-controls': 'Event Controls',
          'admin-filter-type': 'Type',
          'admin-filter-all': 'All',
          'admin-filter-lecture': 'Lecture',
          'admin-filter-exam': 'Exam',
          'admin-filter-meeting': 'Meeting',
          'admin-filter-other': 'Other',
          'admin-filter-course': 'Course',
          'admin-filter-course-placeholder': 'e.g., HCI-201',
          'admin-filter-search': 'Search',
          'admin-filter-search-placeholder': 'Search title/notes',
          'admin-apply-filters': 'Apply Filters',
          'admin-add-edit-event': 'Add / Edit Event',
          'admin-event-title': 'Title',
          'admin-event-title-placeholder': 'Event title',
          'admin-event-time': 'Time',
          'admin-event-type': 'Type',
          'admin-event-lecture': 'Lecture',
          'admin-event-exam': 'Exam',
          'admin-event-meeting': 'Meeting',
          'admin-event-other': 'Other',
          'admin-event-course': 'Course',
          'admin-event-course-placeholder': 'e.g., HCI-201',
          'admin-event-lecturer': 'Lecturer',
          'admin-event-lecturer-placeholder': 'e.g., Dr Zinhle',
          'admin-event-notes': 'Notes',
          'admin-event-notes-placeholder': 'Additional details...',
          'admin-save': 'Save',
          'admin-reset': 'Reset',
          'admin-delete': 'Delete',
          'admin-events-for': 'Events for',
          'admin-select-date': 'Select a date',
          'admin-export-json': 'Export JSON',
          'admin-import-json': 'Import JSON',
          'admin-clear-all': 'Clear All',
          'admin-print': 'Print',
          
          // Users
          'admin-users-title': 'Users',
          'admin-user-role': 'Role',
          'admin-role-admin': 'Admin',
          'admin-role-lecturer': 'Lecturer',
          'admin-role-student': 'Student',
          'admin-user-search': 'Search',
          'admin-user-search-placeholder': 'Name or Email',
          'admin-apply': 'Apply',
          'admin-user-name': 'Name',
          'admin-user-email': 'Email',
          'admin-user-actions': 'Actions',
          'admin-no-users-found': 'No users found.',
          'admin-add-edit-user': 'Add / Edit User',
          'admin-user-full-name': 'Full Name',
          'admin-user-name-placeholder': 'e.g., Bukho Skweza',
          'admin-user-email-placeholder': 'name@example.com',
          'admin-user-password': 'Password',
          'admin-user-password-placeholder': 'Set or change password',
          
          // Lecturers
          'admin-lecturers-title': 'Lecturers',
          'admin-lecturer-department': 'Department',
          'admin-all-departments': 'All Departments',
          'admin-dept-computer-science': 'Computer Science',
          'admin-dept-mathematics': 'Mathematics',
          'admin-dept-physics': 'Physics',
          'admin-dept-engineering': 'Engineering',
          'admin-lecturer-search': 'Search',
          'admin-lecturer-search-placeholder': 'Name or Email',
          'admin-lecturer-name': 'Name',
          'admin-lecturer-email': 'Email',
          'admin-lecturer-office': 'Office',
          'admin-lecturer-phone': 'Phone',
          'admin-lecturer-actions': 'Actions',
          'admin-no-lecturers-found': 'No lecturers found.',
          'admin-add-edit-lecturer': 'Add / Edit Lecturer',
          'admin-lecturer-full-name': 'Full Name',
          'admin-lecturer-name-placeholder': 'e.g., Dr. Soetsang',
          'admin-lecturer-email-placeholder': 'name@example.com',
          'admin-lecturer-password': 'Password',
          'admin-lecturer-password-placeholder': 'Set or change password',
          'admin-lecturer-office-placeholder': 'e.g., Block B, Room 214',
          'admin-lecturer-phone-placeholder': 'e.g., +27 82 123 4567',
          'admin-lecturer-biography': 'Biography',
          'admin-lecturer-bio-placeholder': 'Short bio...',
          
          // Students
          'admin-students-title': 'Students',
          'admin-student-year': 'Year',
          'admin-all-years': 'All Years',
          'admin-year-1': '1st Year',
          'admin-year-2': '2nd Year',
          'admin-year-3': '3rd Year',
          'admin-year-4': '4th Year',
          'admin-student-course': 'Course',
          'admin-student-course-placeholder': 'e.g., HCI-201',
          'admin-student-search': 'Search',
          'admin-student-search-placeholder': 'Name or Email',
          'admin-student-name': 'Name',
          'admin-student-email': 'Email',
          'admin-student-id': 'Student ID',
          'admin-student-actions': 'Actions',
          'admin-no-students-found': 'No students found.',
          'admin-add-edit-student': 'Add / Edit Student',
          'admin-student-full-name': 'Full Name',
          'admin-student-name-placeholder': 'e.g., Bukho Skweza',
          'admin-student-email-placeholder': 'name@example.com',
          'admin-student-password': 'Password',
          'admin-student-password-placeholder': 'Set or change password',
          'admin-student-id-placeholder': 'e.g., 2024001',
          
          // Attendance
          'admin-attendance-overview': 'Attendance Overview',
          'admin-attendance-from': 'From',
          'admin-attendance-to': 'To',
          'admin-attendance-course': 'Course',
          'admin-all-courses': 'All Courses',
          'admin-attendance-lecturer': 'Lecturer',
          'admin-all-lecturers': 'All Lecturers',
          'admin-export-report': 'Export Report',
          'admin-total-sessions': 'Total Sessions',
          'admin-present-students': 'Present Students',
          'admin-absent-students': 'Absent Students',
          'admin-attendance-rate': 'Attendance Rate',
          'admin-attendance-date': 'Date',
          'admin-attendance-session': 'Session',
          'admin-attendance-present': 'Present',
          'admin-attendance-absent': 'Absent',
          'admin-attendance-actions': 'Actions',
          'admin-no-attendance-records': 'No attendance records found.',
          'admin-attendance-reports': 'Attendance Reports',
          'admin-report-type': 'Report Type',
          'admin-report-summary': 'Summary Report',
          'admin-report-detailed': 'Detailed Report',
          'admin-report-student': 'Student Report',
          'admin-report-course': 'Course Report',
          'admin-report-format': 'Format',
          'admin-format-pdf': 'PDF',
          'admin-format-excel': 'Excel',
          'admin-format-csv': 'CSV',
          'admin-generate-report': 'Generate Report',
          
          // Calendar Months
          'admin-month-january': 'January',
          'admin-month-february': 'February',
          'admin-month-march': 'March',
          'admin-month-april': 'April',
          'admin-month-may': 'May',
          'admin-month-june': 'June',
          'admin-month-july': 'July',
          'admin-month-august': 'August',
          'admin-month-september': 'September',
          'admin-month-october': 'October',
          'admin-month-november': 'November',
          'admin-month-december': 'December',
          
          // Calendar Days
          'admin-day-sunday': 'Sun',
          'admin-day-monday': 'Mon',
          'admin-day-tuesday': 'Tue',
          'admin-day-wednesday': 'Wed',
          'admin-day-thursday': 'Thu',
          'admin-day-friday': 'Fri',
          'admin-day-saturday': 'Sat',
          
          // Settings Section
          'admin-default-session-duration': 'Default Session Duration (minutes)',
          'admin-default-session-duration-placeholder': '15',
          'admin-attendance-threshold': 'Attendance Threshold (%)',
          'admin-attendance-threshold-placeholder': '75',
          'admin-auto-archive-days': 'Auto Archive After (days)',
          'admin-auto-archive-days-placeholder': '90',
          'admin-timezone': 'Timezone',
          'admin-notifications': 'Notifications',
          'admin-email-notifications': 'Email Notifications',
          'admin-low-attendance-alerts': 'Low attendance alerts',
          'admin-session-expiry-reminders': 'Session expiry reminders',
          'admin-system-updates': 'System updates',
          'admin-admin-email': 'Admin Email',
          'admin-admin-email-placeholder': 'admin@example.com',
          'admin-notification-frequency': 'Notification Frequency',
          'admin-immediate': 'Immediate',
          'admin-daily-summary': 'Daily Summary',
          'admin-weekly-summary': 'Weekly Summary',
          'admin-security': 'Security',
          'admin-current-password': 'Current Password',
          'admin-new-password': 'New Password',
          'admin-confirm-password': 'Confirm New Password',
          'admin-password-placeholder': '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢',
          'admin-session-timeout': 'Session Timeout (minutes)',
          'admin-session-timeout-placeholder': '30',
          'admin-data-management': 'Data Management',
          'admin-create-backup': 'Create Backup',
          'admin-restore-data': 'Restore Data',
          'admin-clear-all-data': 'Clear All Data',
          'admin-export-all-data': 'Export All Data',
          'admin-backup-recovery-management': 'Backup & Recovery Management',
          'admin-backup-name': 'Backup Name',
          'admin-backup-name-placeholder': 'Enter backup description',
          'admin-backup-type': 'Backup Type',
          'admin-full-system-backup': 'Full System Backup',
          'admin-users-only': 'Users Only',
          'admin-courses-only': 'Courses Only',
          'admin-attendance-only': 'Attendance Only',
          'admin-settings-only': 'Settings Only',
          'admin-export-format': 'Export Format',
          'admin-json-recommended': 'JSON (Recommended)',
          'admin-csv': 'CSV',
          'admin-excel': 'Excel',
          'admin-create-custom-backup': 'Create Custom Backup',
          'admin-automated-backup-settings': 'Automated Backup Settings',
          'admin-enable-auto-backup': 'Enable Auto Backup',
          'admin-enable-automatic-backups': 'Enable automatic backups',
          'admin-backup-frequency': 'Backup Frequency',
          'admin-daily': 'Daily',
          'admin-weekly': 'Weekly',
          'admin-monthly': 'Monthly',
          'admin-backup-time': 'Backup Time',
          'admin-retention-period': 'Retention Period (days)',
          'admin-retention-period-placeholder': '30',
          'admin-save-settings': 'Save Settings',
          'admin-backup-history-management': 'Backup History & Management',
          'admin-recent-backups': 'Recent Backups',
          'admin-refresh': 'Refresh',
          'admin-data-recovery-options': 'Data Recovery Options',
          'admin-recovery-mode': 'Recovery Mode',
          'admin-merge-existing-data': 'Merge with existing data',
          'admin-replace-all-data': 'Replace all data',
          'admin-selective-restore': 'Selective restore',
          'admin-enable-verification': 'Enable Verification',
          'admin-verify-data-integrity': 'Verify data integrity before restore',
          'admin-verify-selected-backup': 'Verify Selected Backup',
          'admin-emergency-restore': 'Emergency Restore',
          'admin-reset-to-defaults': 'Reset to Defaults'
        },
        xh: {
          // Navigation
          'admin-sidebar-title': 'I-Dashboard ye-Admin',
          'nav-dashboard': 'Dashboard',
          'nav-calendar': 'IKhalenda',
          'nav-users': 'Abasebenzisi',
          'nav-lecturers': 'Abafundisi',
          'nav-students': 'Abafundi',
          'nav-courses': 'Izifundo',
          'nav-attendance': 'Ukuba khona',
          'nav-settings': 'Izicwangciso',
          'nav-logout': 'Phuma',
          
          // Dashboard
          'admin-dashboard-title': 'Isishwankathelo se-Dashboard',
          'admin-total-students': 'Abafundi bebonke:',
          'admin-total-lecturers': 'Abafundisi bebonke:',
          'admin-total-courses': 'Izifundo ezipheleleyo:',
          'admin-total-attendance': 'Ukuba khona kwephelele:',
          
          // Settings
          'admin-settings-title': 'Izicwangciso ze-Admin',
          'admin-system-preferences': 'Okukhethiweyo kwiSistim',
          'admin-language-label': 'Ulwimi',
          'language-english': 'IsiNgesi',
          'language-xhosa': 'IsiXhosa',
          'language-sesotho': 'SeSotho',
          'language-setswana': 'SeTswana',
          'language-zulu': 'IsiZulu',
          
          // Calendar
          'admin-calendar-title': 'IKhalenda',
          'admin-event-controls': 'Ulawulo lweMvakalelo',
          'admin-filter-type': 'Uhlobo',
          'admin-filter-all': 'Zonke',
          'admin-filter-lecture': 'Isifundo',
          'admin-filter-exam': 'Uvavanyo',
          'admin-filter-meeting': 'Intlanganiso',
          'admin-filter-other': 'Enye',
          'admin-filter-course': 'Isifundo',
          'admin-filter-course-placeholder': 'umz., HCI-201',
          'admin-filter-search': 'Khangela',
          'admin-filter-search-placeholder': 'Khangela isihloko/amanqaku',
          'admin-apply-filters': 'Faka Izihluzo',
          'admin-add-edit-event': 'Yongeza / Hlela iMvakalelo',
          'admin-event-title': 'Isihloko',
          'admin-event-title-placeholder': 'Isihloko seMvakalelo',
          'admin-event-time': 'Ixesha',
          'admin-event-type': 'Uhlobo',
          'admin-event-lecture': 'Isifundo',
          'admin-event-exam': 'Uvavanyo',
          'admin-event-meeting': 'Intlanganiso',
          'admin-event-other': 'Enye',
          'admin-event-course': 'Isifundo',
          'admin-event-course-placeholder': 'umz., HCI-201',
          'admin-event-lecturer': 'Umfundisi',
          'admin-event-lecturer-placeholder': 'umz., Dr Zinhle',
          'admin-event-notes': 'Amanqaku',
          'admin-event-notes-placeholder': 'Iinkcukacha ezengeziweyo...',
          'admin-save': 'Gcina',
          'admin-reset': 'Buyisela',
          'admin-delete': 'Cima',
          'admin-events-for': 'Iimvakalelo ze',
          'admin-select-date': 'Khetha umhla',
          'admin-export-json': 'Thumela i-JSON',
          'admin-import-json': 'Ngenisa i-JSON',
          'admin-clear-all': 'Cima Zonke',
          'admin-print': 'Shicilela',
          
          // Users
          'admin-users-title': 'Abasebenzisi',
          'admin-user-role': 'Indima',
          'admin-role-admin': 'Umlawuli',
          'admin-role-lecturer': 'Umfundisi',
          'admin-role-student': 'Umfundi',
          'admin-user-search': 'Khangela',
          'admin-user-search-placeholder': 'Igama okanye i-imeyile',
          'admin-apply': 'Faka',
          'admin-user-name': 'Igama',
          'admin-user-email': 'I-imeyile',
          'admin-user-actions': 'Izenzo',
          'admin-no-users-found': 'Akukho basebenzisi bafunyenweyo.',
          'admin-add-edit-user': 'Yongeza / Hlela Umsebenzisi',
          'admin-user-full-name': 'Igama elipheleleyo',
          'admin-user-name-placeholder': 'umz., Bukho Skweza',
          'admin-user-email-placeholder': 'igama@umzekelo.com',
          'admin-user-password': 'Igama lokugqitha',
          'admin-user-password-placeholder': 'Misa okanye tshintsha igama lokugqitha',
          
          // Lecturers
          'admin-lecturers-title': 'Abafundisi',
          'admin-lecturer-department': 'ISebe',
          'admin-all-departments': 'Zonke iSebe',
          'admin-dept-computer-science': 'ISayensi yeKhompyutha',
          'admin-dept-mathematics': 'IMathematika',
          'admin-dept-physics': 'IFiziki',
          'admin-dept-engineering': 'Ubugcisa',
          'admin-lecturer-search': 'Khangela',
          'admin-lecturer-search-placeholder': 'Igama okanye i-imeyile',
          'admin-lecturer-name': 'Igama',
          'admin-lecturer-email': 'I-imeyile',
          'admin-lecturer-office': 'IOfisi',
          'admin-lecturer-phone': 'Ifowuni',
          'admin-lecturer-actions': 'Izenzo',
          'admin-no-lecturers-found': 'Akukho bafundisi bafunyenweyo.',
          'admin-add-edit-lecturer': 'Yongeza / Hlela Umfundisi',
          'admin-lecturer-full-name': 'Igama elipheleleyo',
          'admin-lecturer-name-placeholder': 'umz., Dr. Soetsang',
          'admin-lecturer-email-placeholder': 'igama@umzekelo.com',
          'admin-lecturer-password': 'Igama lokugqitha',
          'admin-lecturer-password-placeholder': 'Misa okanye tshintsha igama lokugqitha',
          'admin-lecturer-office-placeholder': 'umz., Block B, Room 214',
          'admin-lecturer-phone-placeholder': 'umz., +27 82 123 4567',
          'admin-lecturer-biography': 'Ubomi',
          'admin-lecturer-bio-placeholder': 'Ubomi obufutshane...',
          
          // Students
          'admin-students-title': 'Abafundi',
          'admin-student-year': 'Unyaka',
          'admin-all-years': 'Zonke iMinyaka',
          'admin-year-1': 'Unyaka woku-1',
          'admin-year-2': 'Unyaka woku-2',
          'admin-year-3': 'Unyaka woku-3',
          'admin-year-4': 'Unyaka woku-4',
          'admin-student-course': 'Isifundo',
          'admin-student-course-placeholder': 'umz., HCI-201',
          'admin-student-search': 'Khangela',
          'admin-student-search-placeholder': 'Igama okanye i-imeyile',
          'admin-student-name': 'Igama',
          'admin-student-email': 'I-imeyile',
          'admin-student-id': 'ID yomFundi',
          'admin-student-actions': 'Izenzo',
          'admin-no-students-found': 'Akukho bafundi bafunyenweyo.',
          'admin-add-edit-student': 'Yongeza / Hlela Umfundi',
          'admin-student-full-name': 'Igama elipheleleyo',
          'admin-student-name-placeholder': 'umz., Bukho Skweza',
          'admin-student-email-placeholder': 'igama@umzekelo.com',
          'admin-student-password': 'Igama lokugqitha',
          'admin-student-password-placeholder': 'Misa okanye tshintsha igama lokugqitha',
          'admin-student-id-placeholder': 'umz., 2024001',
          
          // Attendance
          'admin-attendance-overview': 'Isishwankathelo soKuba khona',
          'admin-attendance-from': 'Ukusuka',
          'admin-attendance-to': 'Ukuya',
          'admin-attendance-course': 'Isifundo',
          'admin-all-courses': 'Zonke iziFundo',
          'admin-attendance-lecturer': 'Umfundisi',
          'admin-all-lecturers': 'Bonke abaFundisi',
          'admin-export-report': 'Thumela iNgxelo',
          'admin-total-sessions': 'Iiseshoni ezipheleleyo',
          'admin-present-students': 'Abafundi abakhoyo',
          'admin-absent-students': 'Abafundi abangekho',
          'admin-attendance-rate': 'Umlinganiselo woKuba khona',
          'admin-attendance-date': 'Umhla',
          'admin-attendance-session': 'ISeshoni',
          'admin-attendance-present': 'Ukhoyo',
          'admin-attendance-absent': 'Akekho',
          'admin-attendance-actions': 'Izenzo',
          'admin-no-attendance-records': 'Akukho zirekhodi zokuba khona zifunyenweyo.',
          'admin-attendance-reports': 'Iingxelo zoKuba khona',
          'admin-report-type': 'Uhlobo lweNgxelo',
          'admin-report-summary': 'Ingxelo eShwankathelayo',
          'admin-report-detailed': 'Ingxelo eneNkcukacha',
          'admin-report-student': 'Ingxelo yoMfundi',
          'admin-report-course': 'Ingxelo yeSifundo',
          'admin-report-format': 'Ifomati',
          'admin-format-pdf': 'PDF',
          'admin-format-excel': 'Excel',
          'admin-format-csv': 'CSV',
          'admin-generate-report': 'Yenza iNgxelo',
          
          // Calendar Months
          'admin-month-january': 'uJanuwari',
          'admin-month-february': 'uFebruwari',
          'admin-month-march': 'uMatshi',
          'admin-month-april': 'uEpreli',
          'admin-month-may': 'uMeyi',
          'admin-month-june': 'uJuni',
          'admin-month-july': 'uJulayi',
          'admin-month-august': 'uAgasti',
          'admin-month-september': 'uSeptemba',
          'admin-month-october': 'uOktobha',
          'admin-month-november': 'uNovemba',
          'admin-month-december': 'uDisemba',
          
          // Calendar Days
          'admin-day-sunday': 'iCawe',
          'admin-day-monday': 'uMvulo',
          'admin-day-tuesday': 'uLwesibini',
          'admin-day-wednesday': 'uLwesithathu',
          'admin-day-thursday': 'uLwesine',
          'admin-day-friday': 'uLwesihlanu',
          'admin-day-saturday': 'uMgqibelo',
          
          // Settings Section
          'admin-default-session-duration': 'Ubude beSeshoni esiNtandathu (imizuzu)',
          'admin-default-session-duration-placeholder': '15',
          'admin-attendance-threshold': 'Umda woKuba khona (%)',
          'admin-attendance-threshold-placeholder': '75',
          'admin-auto-archive-days': 'Gcina ngokuzenzekelayo Emva (iintsuku)',
          'admin-auto-archive-days-placeholder': '90',
          'admin-timezone': 'Indawo yeNtsuku',
          'admin-notifications': 'IziZaziso',
          'admin-email-notifications': 'IziZaziso ze-imeyile',
          'admin-low-attendance-alerts': 'IziLumkiso zoKuba khona okuPhantsi',
          'admin-session-expiry-reminders': 'IziNkumbuzo zokuPhela kweSeshoni',
          'admin-system-updates': 'IziHlaziyo zeSistim',
          'admin-admin-email': 'I-imeyile ye-Admin',
          'admin-admin-email-placeholder': 'admin@umzekelo.com',
          'admin-notification-frequency': 'Ubuninzi beziZaziso',
          'admin-immediate': 'Ngoko nangoko',
          'admin-daily-summary': 'Isishwankathelo seMini',
          'admin-weekly-summary': 'Isishwankathelo seVeki',
          'admin-security': 'Ukhuseleko',
          'admin-current-password': 'Igama lokugqitha langoku',
          'admin-new-password': 'Igama lokugqitha eliNtsha',
          'admin-confirm-password': 'Qinisekisa Igama lokugqitha eliNtsha',
          'admin-password-placeholder': '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢',
          'admin-session-timeout': 'Isiphelo seSeshoni (imizuzu)',
          'admin-session-timeout-placeholder': '30',
          'admin-data-management': 'Ulawulo lweDatha',
          'admin-create-backup': 'Dala i-Backup',
          'admin-restore-data': 'Buyisela iDatha',
          'admin-clear-all-data': 'Cima Zonke iDatha',
          'admin-export-all-data': 'Thumela Zonke iDatha',
          'admin-backup-recovery-management': 'Ulawulo lwe-Backup & ukuBuyisela',
          'admin-backup-name': 'Igama le-Backup',
          'admin-backup-name-placeholder': 'Ngenisa inkcazelo ye-backup',
          'admin-backup-type': 'Uhlobo lwe-Backup',
          'admin-full-system-backup': 'i-Backup yeSistim epheleleyo',
          'admin-users-only': 'Abasebenzisi kuphela',
          'admin-courses-only': 'Izifundo kuphela',
          'admin-attendance-only': 'Ukuba khona kuphela',
          'admin-settings-only': 'Izicwangciso kuphela',
          'admin-export-format': 'Ifomati yokuThumela',
          'admin-json-recommended': 'JSON (IyeNconywa)',
          'admin-csv': 'CSV',
          'admin-excel': 'Excel',
          'admin-create-custom-backup': 'Dala i-Backup eNgeyeyakho',
          'admin-automated-backup-settings': 'Izicwangciso ze-Backup ezenzekelayo',
          'admin-enable-auto-backup': 'Vumela i-Auto Backup',
          'admin-enable-automatic-backups': 'Vumela i-backups ezenzekelayo',
          'admin-backup-frequency': 'Ubuninzi be-Backup',
          'admin-daily': 'Yonke imihla',
          'admin-weekly': 'Yonke iveki',
          'admin-monthly': 'Yonke inyanga',
          'admin-backup-time': 'Ixesha le-Backup',
          'admin-retention-period': 'Ixesha lokugcina (iintsuku)',
          'admin-retention-period-placeholder': '30',
          'admin-save-settings': 'Gcina Izicwangciso',
          'admin-backup-history-management': 'Ulawulo lweMbali ye-Backup',
          'admin-recent-backups': 'I-Backups zakutshanje',
          'admin-refresh': 'Hlaziya',
          'admin-data-recovery-options': 'Iinketho zokuBuyisela iDatha',
          'admin-recovery-mode': 'Imo yokuBuyisela',
          'admin-merge-existing-data': 'Dibanisa neDatha ekhoyo',
          'admin-replace-all-data': 'Tshintsha Zonke iDatha',
          'admin-selective-restore': 'Ukubuyisela okukhethiweyo',
          'admin-enable-verification': 'Vumela ukuQinisekisa',
          'admin-verify-data-integrity': 'Qinisekisa ukuthembeka kwedatha phambi kokubuyisela',
          'admin-verify-selected-backup': 'Qinisekisa i-Backup ekhethiweyo',
          'admin-emergency-restore': 'Ukubuyisela okuKhawulezayo',
          'admin-reset-to-defaults': 'Buyisela kwiNtandathu'
        },
        st: {
          // Navigation
          'admin-sidebar-title': 'Dashboard ea Admin',
          'nav-dashboard': 'Dashboard',
          'nav-calendar': 'Khalenda',
          'nav-users': 'Basebetsi',
          'nav-lecturers': 'Barutehi',
          'nav-students': 'Baithuti',
          'nav-courses': 'Lithuto',
          'nav-attendance': 'Ho ba teng',
          'nav-settings': 'Litlhophiso',
          'nav-logout': 'Tsoa',
          
          // Dashboard
          'admin-dashboard-title': 'Kakaretso ea Dashboard',
          'admin-total-students': 'Baithuti bohle:',
          'admin-total-lecturers': 'Barutehi bohle:',
          'admin-total-courses': 'Lithuto tsohle:',
          'admin-total-attendance': 'Ho ba teng ka kakaretso:',
          
          // Settings
          'admin-settings-title': 'Litlhophiso tsa Admin',
          'admin-system-preferences': 'Litlhophiso tsa Sisteme',
          'admin-language-label': 'Puo',
          'language-english': 'Senyesemane',
          'language-xhosa': 'Sexhosa',
          'language-sesotho': 'Sesotho',
          'language-setswana': 'Setswana',
          'language-zulu': 'Sezulu',
          
          // Calendar
          'admin-calendar-title': 'Khalenda',
          'admin-event-controls': 'Taolo ea Liketsahalo',
          'admin-filter-type': 'Mofuta',
          'admin-filter-all': 'Tsohle',
          'admin-filter-lecture': 'Thuto',
          'admin-filter-exam': 'Tekolo',
          'admin-filter-meeting': 'Kopano',
          'admin-filter-other': 'Tse ling',
          'admin-filter-course': 'Thuto',
          'admin-filter-course-placeholder': 'mohl., HCI-201',
          'admin-filter-search': 'Batla',
          'admin-filter-search-placeholder': 'Batla sehlooho/lintho',
          'admin-apply-filters': 'Kenya Lifiltha',
          'admin-add-edit-event': 'Kenya / Hlophisa Ketsahalo',
          'admin-event-title': 'Sehlooho',
          'admin-event-title-placeholder': 'Sehlooho sa Ketsahalo',
          'admin-event-time': 'Nako',
          'admin-event-type': 'Mofuta',
          'admin-event-lecture': 'Thuto',
          'admin-event-exam': 'Tekolo',
          'admin-event-meeting': 'Kopano',
          'admin-event-other': 'Tse ling',
          'admin-event-course': 'Thuto',
          'admin-event-course-placeholder': 'mohl., HCI-201',
          'admin-event-lecturer': 'Mofuta',
          'admin-event-lecturer-placeholder': 'mohl., Dr Zinhle',
          'admin-event-notes': 'Lintho',
          'admin-event-notes-placeholder': 'Lintlha tse ling...',
          'admin-save': 'Boloka',
          'admin-reset': 'Khutlisa',
          'admin-delete': 'Hlakola',
          'admin-events-for': 'Liketsahalo tsa',
          'admin-select-date': 'Khetha letsatsi',
          'admin-export-json': 'Romela JSON',
          'admin-import-json': 'Kenya JSON',
          'admin-clear-all': 'Hlakola Tsohle',
          'admin-print': 'Hatisa',
          
          // Users
          'admin-users-title': 'Basebetsi',
          'admin-user-role': 'Sebaka',
          'admin-role-admin': 'Molaoli',
          'admin-role-lecturer': 'Mofuta',
          'admin-role-student': 'Moithuti',
          'admin-user-search': 'Batla',
          'admin-user-search-placeholder': 'Lebitso kapa imeile',
          'admin-apply': 'Kenya',
          'admin-user-name': 'Lebitso',
          'admin-user-email': 'Imeile',
          'admin-user-actions': 'Liketso',
          'admin-no-users-found': 'Ha ho basebetsi ba fumanoeng.',
          'admin-add-edit-user': 'Kenya / Hlophisa Mosebetsi',
          'admin-user-full-name': 'Lebitso le feletseng',
          'admin-user-name-placeholder': 'mohl., Bukho Skweza',
          'admin-user-email-placeholder': 'lebitso@mohlala.com',
          'admin-user-password': 'Lentsoe la ho kena',
          'admin-user-password-placeholder': 'Beha kapa fetola lentsoe la ho kena',
          
          // Lecturers
          'admin-lecturers-title': 'Barutehi',
          'admin-lecturer-department': 'Karo',
          'admin-all-departments': 'Likaro Tsohle',
          'admin-dept-computer-science': 'Saense ea Khomphutha',
          'admin-dept-mathematics': 'Lipalo',
          'admin-dept-physics': 'Fiziki',
          'admin-dept-engineering': 'Boenjiniere',
          'admin-lecturer-search': 'Batla',
          'admin-lecturer-search-placeholder': 'Lebitso kapa imeile',
          'admin-lecturer-name': 'Lebitso',
          'admin-lecturer-email': 'Imeile',
          'admin-lecturer-office': 'Ofisi',
          'admin-lecturer-phone': 'Mohala',
          'admin-lecturer-actions': 'Liketso',
          'admin-no-lecturers-found': 'Ha ho barutehi ba fumanoeng.',
          'admin-add-edit-lecturer': 'Kenya / Hlophisa Mofuta',
          'admin-lecturer-full-name': 'Lebitso le feletseng',
          'admin-lecturer-name-placeholder': 'mohl., Dr. Soetsang',
          'admin-lecturer-email-placeholder': 'lebitso@mohlala.com',
          'admin-lecturer-password': 'Lentsoe la ho kena',
          'admin-lecturer-password-placeholder': 'Beha kapa fetola lentsoe la ho kena',
          'admin-lecturer-office-placeholder': 'mohl., Block B, Room 214',
          'admin-lecturer-phone-placeholder': 'mohl., +27 82 123 4567',
          'admin-lecturer-biography': 'Bophelo',
          'admin-lecturer-bio-placeholder': 'Bophelo bo khutshwane...',
          
          // Students
          'admin-students-title': 'Baithuti',
          'admin-student-year': 'Selemo',
          'admin-all-years': 'Lilemo Tsohle',
          'admin-year-1': 'Selemo sa 1',
          'admin-year-2': 'Selemo sa 2',
          'admin-year-3': 'Selemo sa 3',
          'admin-year-4': 'Selemo sa 4',
          'admin-student-course': 'Thuto',
          'admin-student-course-placeholder': 'mohl., HCI-201',
          'admin-student-search': 'Batla',
          'admin-student-search-placeholder': 'Lebitso kapa imeile',
          'admin-student-name': 'Lebitso',
          'admin-student-email': 'Imeile',
          'admin-student-id': 'ID ea Moithuti',
          'admin-student-actions': 'Liketso',
          'admin-no-students-found': 'Ha ho baithuti ba fumanoeng.',
          'admin-add-edit-student': 'Kenya / Hlophisa Moithuti',
          'admin-student-full-name': 'Lebitso le feletseng',
          'admin-student-name-placeholder': 'mohl., Bukho Skweza',
          'admin-student-email-placeholder': 'lebitso@mohlala.com',
          'admin-student-password': 'Lentsoe la ho kena',
          'admin-student-password-placeholder': 'Beha kapa fetola lentsoe la ho kena',
          'admin-student-id-placeholder': 'mohl., 2024001',
          
          // Attendance
          'admin-attendance-overview': 'Kakaretso ea ho ba teng',
          'admin-attendance-from': 'Ho tloha',
          'admin-attendance-to': 'Ho ea',
          'admin-attendance-course': 'Thuto',
          'admin-all-courses': 'Lithuto Tsohle',
          'admin-attendance-lecturer': 'Mofuta',
          'admin-all-lecturers': 'Barutehi Bohle',
          'admin-export-report': 'Romela Phatlalatso',
          'admin-total-sessions': 'Likopano tsohle',
          'admin-present-students': 'Baithuti ba teng',
          'admin-absent-students': 'Baithuti ba sa teng',
          'admin-attendance-rate': 'Tekanyo ea ho ba teng',
          'admin-attendance-date': 'Letsatsi',
          'admin-attendance-session': 'Kopano',
          'admin-attendance-present': 'E teng',
          'admin-attendance-absent': 'Ha e teng',
          'admin-attendance-actions': 'Liketso',
          'admin-no-attendance-records': 'Ha ho lilekodi tsa ho ba teng tse fumanoeng.',
          'admin-attendance-reports': 'Liphatlalatso tsa ho ba teng',
          'admin-report-type': 'Mofuta oa Phatlalatso',
          'admin-report-summary': 'Phatlalatso e Khutshwane',
          'admin-report-detailed': 'Phatlalatso e Ntle',
          'admin-report-student': 'Phatlalatso ea Moithuti',
          'admin-report-course': 'Phatlalatso ea Thuto',
          'admin-report-format': 'Sebopeho',
          'admin-format-pdf': 'PDF',
          'admin-format-excel': 'Excel',
          'admin-format-csv': 'CSV',
          'admin-generate-report': 'Etsa Phatlalatso',
          
          // Calendar Months
          'admin-month-january': 'Pherekgong',
          'admin-month-february': 'Hlakola',
          'admin-month-march': 'Hlakubele',
          'admin-month-april': 'Mmese',
          'admin-month-may': 'Motsheanong',
          'admin-month-june': 'Phupjane',
          'admin-month-july': 'Phupu',
          'admin-month-august': 'Phato',
          'admin-month-september': 'Leotshe',
          'admin-month-october': 'Mphalane',
          'admin-month-november': 'Pudungwana',
          'admin-month-december': 'Tshitwe',
          
          // Calendar Days
          'admin-day-sunday': 'Sontaha',
          'admin-day-monday': 'Mantaha',
          'admin-day-tuesday': 'Labobeli',
          'admin-day-wednesday': 'Laboraro',
          'admin-day-thursday': 'Labone',
          'admin-day-friday': 'Labohlano',
          'admin-day-saturday': 'Moqebelo',
          
          // Settings Section
          'admin-default-session-duration': 'Bolelele ba Kopano ea Tlhaho (metsotso)',
          'admin-default-session-duration-placeholder': '15',
          'admin-attendance-threshold': 'Moele oa ho ba teng (%)',
          'admin-attendance-threshold-placeholder': '75',
          'admin-auto-archive-days': 'Boloka ka boikemelo Ka mora (matsatsi)',
          'admin-auto-archive-days-placeholder': '90',
          'admin-timezone': 'Sebaka sa Nako',
          'admin-notifications': 'Litsebiso',
          'admin-email-notifications': 'Litsebiso tsa Imeile',
          'admin-low-attendance-alerts': 'Litsebiso tsa ho ba teng ho tlase',
          'admin-session-expiry-reminders': 'Litsebiso tsa ho fela ha Kopano',
          'admin-system-updates': 'Litlhophiso tsa Sisteme',
          'admin-admin-email': 'Imeile ea Admin',
          'admin-admin-email-placeholder': 'admin@mohlala.com',
          'admin-notification-frequency': 'Boholo ba Litsebiso',
          'admin-immediate': 'Hang-hang',
          'admin-daily-summary': 'Kakaretso ea Letsatsi',
          'admin-weekly-summary': 'Kakaretso ea Beke',
          'admin-security': 'T≈°ireletso',
          'admin-current-password': 'Lentsoe la ho kena la hona joale',
          'admin-new-password': 'Lentsoe la ho kena le ncha',
          'admin-confirm-password': 'Netefatsa Lentsoe la ho kena le ncha',
          'admin-password-placeholder': '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢',
          'admin-session-timeout': 'Ho fela ha Kopano (metsotso)',
          'admin-session-timeout-placeholder': '30',
          'admin-data-management': 'Taolo ea Lintlha',
          'admin-create-backup': 'Etsa Backup',
          'admin-restore-data': 'Khutlisa Lintlha',
          'admin-clear-all-data': 'Hlakola Lintlha Tsohle',
          'admin-export-all-data': 'Romela Lintlha Tsohle',
          'admin-backup-recovery-management': 'Taolo ea Backup & ho Khutlisa',
          'admin-backup-name': 'Lebitso la Backup',
          'admin-backup-name-placeholder': 'Kenya tlhaloso ea backup',
          'admin-backup-type': 'Mofuta oa Backup',
          'admin-full-system-backup': 'Backup ea Sisteme e feletseng',
          'admin-users-only': 'Basebetsi feela',
          'admin-courses-only': 'Lithuto feela',
          'admin-attendance-only': 'Ho ba teng feela',
          'admin-settings-only': 'Litlhophiso feela',
          'admin-export-format': 'Sebopeho sa ho Romela',
          'admin-json-recommended': 'JSON (E Khothalelang)',
          'admin-csv': 'CSV',
          'admin-excel': 'Excel',
          'admin-create-custom-backup': 'Etsa Backup e Ikhethang',
          'admin-automated-backup-settings': 'Litlhophiso tsa Backup e ikemetseng',
          'admin-enable-auto-backup': 'Khothaletsa Auto Backup',
          'admin-enable-automatic-backups': 'Khothaletsa li-backups tse ikemetseng',
          'admin-backup-frequency': 'Boholo ba Backup',
          'admin-daily': 'Letsatsi le letsatsi',
          'admin-weekly': 'Beke le beke',
          'admin-monthly': 'Kgwedi le kgwedi',
          'admin-backup-time': 'Nako ea Backup',
          'admin-retention-period': 'Nako ea ho boloka (matsatsi)',
          'admin-retention-period-placeholder': '30',
          'admin-save-settings': 'Boloka Litlhophiso',
          'admin-backup-history-management': 'Taolo ea Histori ea Backup',
          'admin-recent-backups': 'Li-backups tsa haufi',
          'admin-refresh': 'Ntlafatsa',
          'admin-data-recovery-options': 'Lintlha tsa ho Khutlisa Lintlha',
          'admin-recovery-mode': 'Mokhoa oa ho Khutlisa',
          'admin-merge-existing-data': 'Kopanya le Lintlha tse teng',
          'admin-replace-all-data': 'Ntlafatsa Lintlha Tsohle',
          'admin-selective-restore': 'Ho khutlisa ho ikhethang',
          'admin-enable-verification': 'Khothaletsa ho Netefatsa',
          'admin-verify-data-integrity': 'Netefatsa boit≈°oaro ba lintlha pele ho khutlisa',
          'admin-verify-selected-backup': 'Netefatsa Backup e khethiloeng',
          'admin-emergency-restore': 'Ho Khutlisa ka Potlako',
          'admin-reset-to-defaults': 'Khutlisa ho Litlhophiso tsa Tlhaho'
        },
        tn: {
          // Navigation
          'admin-sidebar-title': 'Dashboard ya Admin',
          'nav-dashboard': 'Dashboard',
          'nav-calendar': 'Khalenda',
          'nav-users': 'Badiragatsi',
          'nav-lecturers': 'Barutisi',
          'nav-students': 'Baithuti',
          'nav-courses': 'Dithuto',
          'nav-attendance': 'Go ba teng',
          'nav-settings': 'Ditlhophiso',
          'nav-logout': 'Tswa',
          
          // Dashboard
          'admin-dashboard-title': 'Kakaretso ya Dashboard',
          'admin-total-students': 'Baithuti botlhe:',
          'admin-total-lecturers': 'Barutisi botlhe:',
          'admin-total-courses': 'Dithuto tsotlhe:',
          'admin-total-attendance': 'Go ba teng ka kakaretso:',
          
          // Settings
          'admin-settings-title': 'Ditlhophiso tsa Admin',
          'admin-system-preferences': 'Ditlhophiso tsa Sisteme',
          'admin-language-label': 'Puo',
          'language-english': 'Sekgowa',
          'language-xhosa': 'Sexhosa',
          'language-sesotho': 'Sesotho',
          'language-setswana': 'Setswana',
          'language-zulu': 'Sezulu',
          
          // Calendar
          'admin-calendar-title': 'Khalenda',
          'admin-event-controls': 'Taolo ya Diketsahalo',
          'admin-filter-type': 'Mofuta',
          'admin-filter-all': 'Tsotlhe',
          'admin-filter-lecture': 'Thuto',
          'admin-filter-exam': 'Tekolo',
          'admin-filter-meeting': 'Kopano',
          'admin-filter-other': 'Tse dingwe',
          'admin-filter-course': 'Thuto',
          'admin-filter-course-placeholder': 'mohl., HCI-201',
          'admin-filter-search': 'Batla',
          'admin-filter-search-placeholder': 'Batla sehlogo/dintlha',
          'admin-apply-filters': 'Kenya Difiltha',
          'admin-add-edit-event': 'Kenya / Hlophisa Ketsahalo',
          'admin-event-title': 'Sehlogo',
          'admin-event-title-placeholder': 'Sehlogo sa Ketsahalo',
          'admin-event-time': 'Nako',
          'admin-event-type': 'Mofuta',
          'admin-event-lecture': 'Thuto',
          'admin-event-exam': 'Tekolo',
          'admin-event-meeting': 'Kopano',
          'admin-event-other': 'Tse dingwe',
          'admin-event-course': 'Thuto',
          'admin-event-course-placeholder': 'mohl., HCI-201',
          'admin-event-lecturer': 'Morutisi',
          'admin-event-lecturer-placeholder': 'mohl., Dr Zinhle',
          'admin-event-notes': 'Dintlha',
          'admin-event-notes-placeholder': 'Dintlha tse dingwe...',
          'admin-save': 'Boloka',
          'admin-reset': 'Khutlisa',
          'admin-delete': 'Tlosa',
          'admin-events-for': 'Diketsahalo tsa',
          'admin-select-date': 'Kgethe letsatsi',
          'admin-export-json': 'Romela JSON',
          'admin-import-json': 'Kenya JSON',
          'admin-clear-all': 'Tlosa Tsotlhe',
          'admin-print': 'Hatisa',
          
          // Users
          'admin-users-title': 'Badiragatsi',
          'admin-user-role': 'Sebaka',
          'admin-role-admin': 'Molaodi',
          'admin-role-lecturer': 'Morutisi',
          'admin-role-student': 'Moithuti',
          'admin-user-search': 'Batla',
          'admin-user-search-placeholder': 'Leina kgotsa imeile',
          'admin-apply': 'Kenya',
          'admin-user-name': 'Leina',
          'admin-user-email': 'Imeile',
          'admin-user-actions': 'Dikgato',
          'admin-no-users-found': 'Ga go na badiragatsi ba fitlhelwang.',
          'admin-add-edit-user': 'Kenya / Hlophisa Mosebetsi',
          'admin-user-full-name': 'Leina le feletseng',
          'admin-user-name-placeholder': 'mohl., Bukho Skweza',
          'admin-user-email-placeholder': 'leina@mohlala.com',
          'admin-user-password': 'Lentswe la go tsena',
          'admin-user-password-placeholder': 'Bea kgotsa fetola lentswe la go tsena',
          
          // Lecturers
          'admin-lecturers-title': 'Barutisi',
          'admin-lecturer-department': 'Kgaolo',
          'admin-all-departments': 'Dikgaolo Tsotlhe',
          'admin-dept-computer-science': 'Saense ya Khomphutha',
          'admin-dept-mathematics': 'Dipalo',
          'admin-dept-physics': 'Fiziki',
          'admin-dept-engineering': 'Boenjiniere',
          'admin-lecturer-search': 'Batla',
          'admin-lecturer-search-placeholder': 'Leina kgotsa imeile',
          'admin-lecturer-name': 'Leina',
          'admin-lecturer-email': 'Imeile',
          'admin-lecturer-office': 'Ofisi',
          'admin-lecturer-phone': 'Mohala',
          'admin-lecturer-actions': 'Dikgato',
          'admin-no-lecturers-found': 'Ga go na barutisi ba fitlhelwang.',
          'admin-add-edit-lecturer': 'Kenya / Hlophisa Morutisi',
          'admin-lecturer-full-name': 'Leina le feletseng',
          'admin-lecturer-name-placeholder': 'mohl., Dr. Soetsang',
          'admin-lecturer-email-placeholder': 'leina@mohlala.com',
          'admin-lecturer-password': 'Lentswe la go tsena',
          'admin-lecturer-password-placeholder': 'Bea kgotsa fetola lentswe la go tsena',
          'admin-lecturer-office-placeholder': 'mohl., Block B, Room 214',
          'admin-lecturer-phone-placeholder': 'mohl., +27 82 123 4567',
          'admin-lecturer-biography': 'Bophelo',
          'admin-lecturer-bio-placeholder': 'Bophelo bo khutshwane...',
          
          // Students
          'admin-students-title': 'Baithuti',
          'admin-student-year': 'Ngwaga',
          'admin-all-years': 'Dingwaga Tsotlhe',
          'admin-year-1': 'Ngwaga wa 1',
          'admin-year-2': 'Ngwaga wa 2',
          'admin-year-3': 'Ngwaga wa 3',
          'admin-year-4': 'Ngwaga wa 4',
          'admin-student-course': 'Thuto',
          'admin-student-course-placeholder': 'mohl., HCI-201',
          'admin-student-search': 'Batla',
          'admin-student-search-placeholder': 'Leina kgotsa imeile',
          'admin-student-name': 'Leina',
          'admin-student-email': 'Imeile',
          'admin-student-id': 'ID ya Moithuti',
          'admin-student-actions': 'Dikgato',
          'admin-no-students-found': 'Ga go na baithuti ba fitlhelwang.',
          'admin-add-edit-student': 'Kenya / Hlophisa Moithuti',
          'admin-student-full-name': 'Leina le feletseng',
          'admin-student-name-placeholder': 'mohl., Bukho Skweza',
          'admin-student-email-placeholder': 'leina@mohlala.com',
          'admin-student-password': 'Lentswe la go tsena',
          'admin-student-password-placeholder': 'Bea kgotsa fetola lentswe la go tsena',
          'admin-student-id-placeholder': 'mohl., 2024001',
          
          // Attendance
          'admin-attendance-overview': 'Kakaretso ya go ba teng',
          'admin-attendance-from': 'Go tswa',
          'admin-attendance-to': 'Go ya',
          'admin-attendance-course': 'Thuto',
          'admin-all-courses': 'Dithuto Tsotlhe',
          'admin-attendance-lecturer': 'Morutisi',
          'admin-all-lecturers': 'Barutisi Botlhe',
          'admin-export-report': 'Romela Phatlalatso',
          'admin-total-sessions': 'Dikopano tsotlhe',
          'admin-present-students': 'Baithuti ba teng',
          'admin-absent-students': 'Baithuti ba sa teng',
          'admin-attendance-rate': 'Tekanyo ya go ba teng',
          'admin-attendance-date': 'Letsatsi',
          'admin-attendance-session': 'Kopano',
          'admin-attendance-present': 'E teng',
          'admin-attendance-absent': 'Ga e teng',
          'admin-attendance-actions': 'Dikgato',
          'admin-no-attendance-records': 'Ga go na direkodi tsa go ba teng tse di fitlhelwang.',
          'admin-attendance-reports': 'Diphatlalatso tsa go ba teng',
          'admin-report-type': 'Mofuta wa Phatlalatso',
          'admin-report-summary': 'Phatlalatso e Khutshwane',
          'admin-report-detailed': 'Phatlalatso e Ntle',
          'admin-report-student': 'Phatlalatso ya Moithuti',
          'admin-report-course': 'Phatlalatso ya Thuto',
          'admin-report-format': 'Sebopeho',
          'admin-format-pdf': 'PDF',
          'admin-format-excel': 'Excel',
          'admin-format-csv': 'CSV',
          'admin-generate-report': 'Etsa Phatlalatso',
          
          // Calendar Months
          'admin-month-january': 'Ferikgong',
          'admin-month-february': 'Tlhakole',
          'admin-month-march': 'Mopitlo',
          'admin-month-april': 'Moranang',
          'admin-month-may': 'Motsheganong',
          'admin-month-june': 'Seetebosigo',
          'admin-month-july': 'Phukwi',
          'admin-month-august': 'Phatwe',
          'admin-month-september': 'Lwetse',
          'admin-month-october': 'Diphalane',
          'admin-month-november': 'Ngwanatsele',
          'admin-month-december': 'Sedimonthole',
          
          // Calendar Days
          'admin-day-sunday': 'Tshipi',
          'admin-day-monday': 'Mosupologo',
          'admin-day-tuesday': 'Labobedi',
          'admin-day-wednesday': 'Laboraro',
          'admin-day-thursday': 'Labone',
          'admin-day-friday': 'Labotlhano',
          'admin-day-saturday': 'Matlhatso',
          
          // Settings Section
          'admin-default-session-duration': 'Bolelele jwa Kopano ya Tlhago (metsotso)',
          'admin-default-session-duration-placeholder': '15',
          'admin-attendance-threshold': 'Mogala wa go ba teng (%)',
          'admin-attendance-threshold-placeholder': '75',
          'admin-auto-archive-days': 'Boloka ka boikemelo Morago ga (matsatsi)',
          'admin-auto-archive-days-placeholder': '90',
          'admin-timezone': 'Lefelo la Nako',
          'admin-notifications': 'Ditsebiso',
          'admin-email-notifications': 'Ditsebiso tsa Imeile',
          'admin-low-attendance-alerts': 'Ditsebiso tsa go ba teng go tlase',
          'admin-session-expiry-reminders': 'Ditsebiso tsa go fela ga Kopano',
          'admin-system-updates': 'Ditlhophiso tsa Sisteme',
          'admin-admin-email': 'Imeile ya Admin',
          'admin-admin-email-placeholder': 'admin@mohlala.com',
          'admin-notification-frequency': 'Bogolo jwa Ditsebiso',
          'admin-immediate': 'Ka bonako',
          'admin-daily-summary': 'Kakaretso ya Letsatsi',
          'admin-weekly-summary': 'Kakaretso ya Beke',
          'admin-security': 'Tshireletso',
          'admin-current-password': 'Lentswe la go tsena la gompieno',
          'admin-new-password': 'Lentswe la go tsena le masha',
          'admin-confirm-password': 'Netefatsa Lentswe la go tsena le masha',
          'admin-password-placeholder': '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢',
          'admin-session-timeout': 'Go fela ga Kopano (metsotso)',
          'admin-session-timeout-placeholder': '30',
          'admin-data-management': 'Taolo ya Dintlha',
          'admin-create-backup': 'Etsa Backup',
          'admin-restore-data': 'Busetsa Dintlha',
          'admin-clear-all-data': 'Hlakola Dintlha Tsotlhe',
          'admin-export-all-data': 'Romela Dintlha Tsotlhe',
          'admin-backup-recovery-management': 'Taolo ya Backup & go Busetsa',
          'admin-backup-name': 'Leina la Backup',
          'admin-backup-name-placeholder': 'Kenya tlhaloso ya backup',
          'admin-backup-type': 'Mofuta wa Backup',
          'admin-full-system-backup': 'Backup ya Sisteme e feletseng',
          'admin-users-only': 'Badiragatsi fela',
          'admin-courses-only': 'Dithuto fela',
          'admin-attendance-only': 'Go ba teng fela',
          'admin-settings-only': 'Ditlhophiso fela',
          'admin-export-format': 'Sebopeho sa go Romela',
          'admin-json-recommended': 'JSON (E Khothalelang)',
          'admin-csv': 'CSV',
          'admin-excel': 'Excel',
          'admin-create-custom-backup': 'Etsa Backup e Ikhethang',
          'admin-automated-backup-settings': 'Ditlhophiso tsa Backup e ikemetseng',
          'admin-enable-auto-backup': 'Khothaletsa Auto Backup',
          'admin-enable-automatic-backups': 'Khothaletsa di-backups tse ikemetseng',
          'admin-backup-frequency': 'Bogolo jwa Backup',
          'admin-daily': 'Letsatsi le letsatsi',
          'admin-weekly': 'Beke le beke',
          'admin-monthly': 'Kgwedi le kgwedi',
          'admin-backup-time': 'Nako ya Backup',
          'admin-retention-period': 'Nako ya go boloka (matsatsi)',
          'admin-retention-period-placeholder': '30',
          'admin-save-settings': 'Boloka Ditlhophiso',
          'admin-backup-history-management': 'Taolo ya Histori ya Backup',
          'admin-recent-backups': 'Di-backups tsa haufi',
          'admin-refresh': 'Ntlafatsa',
          'admin-data-recovery-options': 'Dintlha tsa go Busetsa Dintlha',
          'admin-recovery-mode': 'Mokgwa wa go Busetsa',
          'admin-merge-existing-data': 'Kopanya le Dintlha tse di teng',
          'admin-replace-all-data': 'Ntlafatsa Dintlha Tsotlhe',
          'admin-selective-restore': 'Go busetsa go ikhethang',
          'admin-enable-verification': 'Khothaletsa go Netefatsa',
          'admin-verify-data-integrity': 'Netefatsa boit≈°oaro jwa dintlha pele ga go busetsa',
          'admin-verify-selected-backup': 'Netefatsa Backup e khethilweng',
          'admin-emergency-restore': 'Go Busetsa ka Potlako',
          'admin-reset-to-defaults': 'Busetsa go Ditlhophiso tsa Tlhago'
        },
        zu: {
          // Navigation
          'admin-sidebar-title': 'I-Dashboard ye-Admin',
          'nav-dashboard': 'I-Dashboard',
          'nav-calendar': 'Ikhalenda',
          'nav-users': 'Abasebenzisi',
          'nav-lecturers': 'Abafundisi',
          'nav-students': 'Abafundi',
          'nav-courses': 'Izifundo',
          'nav-attendance': 'Ukuba khona',
          'nav-settings': 'Izilungiselelo',
          'nav-logout': 'Phuma',
          
          // Dashboard
          'admin-dashboard-title': 'I-Dashboard',
          'admin-total-students': 'Abafundi abaphelele',
          'admin-total-lecturers': 'Abafundisi abaphelele',
          'admin-total-courses': 'Izifundo eziphelele',
          'admin-total-attendance': 'Ukuba khona okuphelele',
          
          // Settings
          'admin-settings-title': 'Izilungiselelo ze-Admin',
          'admin-system-preferences': 'Okukhethiweyo kwiSistimu',
          'admin-language-label': 'Ulimi',
          'language-english': 'IsiNgisi',
          'language-xhosa': 'IsiXhosa',
          'language-sesotho': 'SeSotho',
          'language-setswana': 'SeTswana',
          'language-zulu': 'IsiZulu',
          
          // Calendar
          'admin-calendar-title': 'Ikhalenda',
          'admin-event-controls': 'Ulawulo lweMvakalelo',
          'admin-filter-type': 'Uhlobo',
          'admin-filter-all': 'Konke',
          'admin-filter-lecture': 'Isifundo',
          'admin-filter-exam': 'Ukuhlolwa',
          'admin-filter-assignment': 'Umsebenzi',
          'admin-filter-other': 'Okunye',
          'admin-filter-course': 'Isifundo',
          'admin-filter-course-placeholder': 'njeng., HCI-201',
          'admin-filter-search': 'Sesha',
          'admin-filter-search-placeholder': 'Sesha imvakalelo...',
          'admin-filter-apply': 'Faka isicelo',
          'admin-add-edit-event': 'Engeza/Hlela Imvakalelo',
          'admin-event-title': 'Isihloko',
          'admin-event-title-placeholder': 'Faka isihloko semvakalelo',
          'admin-event-time': 'Isikhathi',
          'admin-event-type': 'Uhlobo',
          'admin-event-course': 'Isifundo',
          'admin-event-course-placeholder': 'Khetha isifundo',
          'admin-event-lecturer': 'Umfundisi',
          'admin-event-lecturer-placeholder': 'Khetha umfundisi',
          'admin-event-notes': 'Amanothi',
          'admin-event-notes-placeholder': 'Faka amanothi...',
          'admin-event-save': 'Gcina',
          'admin-event-reset': 'Buyisela',
          'admin-event-delete': 'Susa',
          'admin-events-for': 'Imvakalelo ye',
          'admin-export-json': 'Thumela i-JSON',
          'admin-import-json': 'Ngenisa i-JSON',
          'admin-print': 'Shicilela',
          'admin-clear-all': 'Sula konke',
          
          // Users
          'admin-users-title': 'Abasebenzisi',
          'admin-filter-role': 'Indima',
          'admin-filter-active': 'Kusebenzayo',
          'admin-filter-inactive': 'Akusebenzi',
          'admin-filter-export': 'Thumela',
          'admin-filter-import': 'Ngenisa',
          'admin-user-name': 'Igama',
          'admin-user-email': 'I-imeyili',
          'admin-user-role': 'Indima',
          'admin-user-status': 'Isimo',
          'admin-user-actions': 'Izenzo',
          'admin-no-users-found': 'Awukho abasebenzisi abatholakele',
          'admin-add-edit-user': 'Engeza/Hlela Umsebenzisi',
          'admin-user-password': 'Iphasiwedi',
          'admin-user-password-placeholder': 'Faka iphasiwedi',
          'admin-user-confirm-password': 'Qinisekisa iphasiwedi',
          'admin-user-confirm-password-placeholder': 'Qinisekisa iphasiwedi',
          'admin-user-save': 'Gcina',
          'admin-user-reset': 'Buyisela',
          
          // Lecturers
          'admin-lecturers-title': 'Abafundisi',
          'admin-filter-department': 'Umnyango',
          'admin-filter-experience': 'Isipiliyoni',
          'admin-lecturer-name': 'Igama',
          'admin-lecturer-email': 'I-imeyili',
          'admin-lecturer-department': 'Umnyango',
          'admin-lecturer-experience': 'Isipiliyoni',
          'admin-lecturer-status': 'Isimo',
          'admin-lecturer-actions': 'Izenzo',
          'admin-no-lecturers-found': 'Awukho abafundisi abatholakele',
          'admin-add-edit-lecturer': 'Engeza/Hlela Umfundisi',
          'admin-lecturer-phone': 'Ucingo',
          'admin-lecturer-phone-placeholder': 'Faka inombolo yocingo',
          'admin-lecturer-save': 'Gcina',
          'admin-lecturer-reset': 'Buyisela',
          
          // Students
          'admin-students-title': 'Abafundi',
          'admin-filter-year': 'Unyaka',
          'admin-filter-grade': 'Isilinganiso',
          'admin-student-name': 'Igama',
          'admin-student-email': 'I-imeyili',
          'admin-student-year': 'Unyaka',
          'admin-student-grade': 'Isilinganiso',
          'admin-student-status': 'Isimo',
          'admin-student-actions': 'Izenzo',
          'admin-no-students-found': 'Awukho abafundi abatholakele',
          'admin-add-edit-student': 'Engeza/Hlela Umfundi',
          'admin-student-id': 'Isazisi',
          'admin-student-id-placeholder': 'Faka isazisi somfundi',
          'admin-student-save': 'Gcina',
          'admin-student-reset': 'Buyisela',
          
          // Attendance
          'admin-attendance-overview': 'Ukubuka Ukuba Khona',
          'admin-attendance-from': 'Kusuka',
          'admin-attendance-to': 'Kuya',
          'admin-attendance-course': 'Isifundo',
          'admin-attendance-lecturer': 'Umfundisi',
          'admin-attendance-present': 'Kukhona',
          'admin-attendance-absent': 'Akekho',
          'admin-attendance-late': 'Ufike emuva kwesikhathi',
          'admin-attendance-total': 'Isamba',
          'admin-attendance-rate': 'Izinga lokuba khona',
          'admin-attendance-date': 'Usuku',
          'admin-attendance-status': 'Isimo',
          'admin-no-attendance-records-found': 'Awukho amarekhodi okuba khona atholakele',
          'admin-attendance-reports': 'Imibiko Yokuba Khona',
          'admin-report-type': 'Uhlobo lwembiko',
          'admin-report-format': 'Ifomethi',
          'admin-report-summary': 'Umbiko oMfushane',
          'admin-report-detailed': 'Umbiko oNgcwele',
          'admin-report-student': 'Umbiko Womfundi',
          'admin-report-course': 'Umbiko Wesifundo',
          'admin-format-pdf': 'PDF',
          'admin-format-excel': 'Excel',
          'admin-format-csv': 'CSV',
          'admin-generate-report': 'Dala Umbiko',
          
          // Calendar Months
          'admin-month-january': 'uMasingana',
          'admin-month-february': 'uNhlolanja',
          'admin-month-march': 'uNdasa',
          'admin-month-april': 'uMbasa',
          'admin-month-may': 'uNhlaba',
          'admin-month-june': 'uNhlangulana',
          'admin-month-july': 'uNtulikazi',
          'admin-month-august': 'uNcwaba',
          'admin-month-september': 'uMandulo',
          'admin-month-october': 'uMfumfu',
          'admin-month-november': 'uLwezi',
          'admin-month-december': 'uZibandlela',
          
          // Calendar Days
          'admin-day-sunday': 'iSonto',
          'admin-day-monday': 'uMsombuluko',
          'admin-day-tuesday': 'uLwesibili',
          'admin-day-wednesday': 'uLwesithathu',
          'admin-day-thursday': 'uLwesine',
          'admin-day-friday': 'uLwesihlanu',
          'admin-day-saturday': 'uMgqibelo',
          
          // Settings Section
          'admin-default-session-duration': 'Ubude beSeshoni esiNtandathu (imizuzu)',
          'admin-default-session-duration-placeholder': '15',
          'admin-attendance-threshold': 'Umda woKuba khona (%)',
          'admin-attendance-threshold-placeholder': '75',
          'admin-auto-archive-days': 'Gcina ngokuzenzekelayo Emva (iintsuku)',
          'admin-auto-archive-days-placeholder': '90',
          'admin-timezone': 'Indawo yeNtsuku',
          'admin-notifications': 'IziZaziso',
          'admin-email-notifications': 'IziZaziso ze-imeyile',
          'admin-low-attendance-alerts': 'IziLumkiso zoKuba khona okuPhantsi',
          'admin-session-expiry-reminders': 'IziNkumbuzo zokuPhela kweSeshoni',
          'admin-system-updates': 'IziHlaziyo zeSistimu',
          'admin-admin-email': 'I-imeyile ye-Admin',
          'admin-admin-email-placeholder': 'admin@umzekelo.com',
          'admin-notification-frequency': 'Ubuninzi beziZaziso',
          'admin-immediate': 'Ngoko nangoko',
          'admin-daily-summary': 'Isishwankathelo seMini',
          'admin-weekly-summary': 'Isishwankathelo seVeki',
          'admin-security': 'Ukhuseleko',
          'admin-current-password': 'Iphasiwedi yangoku',
          'admin-new-password': 'Iphasiwedi entsha',
          'admin-confirm-password': 'Qinisekisa iphasiwedi entsha',
          'admin-password-placeholder': '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢',
          'admin-session-timeout': 'Isiphelo seSeshoni (imizuzu)',
          'admin-session-timeout-placeholder': '30',
          'admin-data-management': 'Ulawulo lweDatha',
          'admin-create-backup': 'Dala i-Backup',
          'admin-restore-data': 'Buyisela iDatha',
          'admin-clear-all-data': 'Sula Zonke iDatha',
          'admin-export-all-data': 'Thumela Zonke iDatha',
          'admin-backup-recovery-management': 'Ulawulo lwe-Backup & ukuBuyisela',
          'admin-backup-name': 'Igama le-Backup',
          'admin-backup-name-placeholder': 'Ngenisa inkcazelo ye-backup',
          'admin-backup-type': 'Uhlobo lwe-Backup',
          'admin-full-system-backup': 'i-Backup yeSistimu epheleleyo',
          'admin-users-only': 'Abasebenzisi kuphela',
          'admin-courses-only': 'Izifundo kuphela',
          'admin-attendance-only': 'Ukuba khona kuphela',
          'admin-settings-only': 'Izilungiselelo kuphela',
          'admin-export-format': 'Ifomethi yokuThumela',
          'admin-json-recommended': 'JSON (IyeNconywa)',
          'admin-csv': 'CSV',
          'admin-excel': 'Excel',
          'admin-create-custom-backup': 'Dala i-Backup eNgeyeyakho',
          'admin-automated-backup-settings': 'Izilungiselelo ze-Backup ezenzekelayo',
          'admin-enable-auto-backup': 'Vumela i-Auto Backup',
          'admin-enable-automatic-backups': 'Vumela i-backups ezenzekelayo',
          'admin-backup-frequency': 'Ubuninzi be-Backup',
          'admin-daily': 'Yonke imihla',
          'admin-weekly': 'Yonke iveki',
          'admin-monthly': 'Yonke inyanga',
          'admin-backup-time': 'Isikhathi se-Backup',
          'admin-retention-period': 'Isikhathi sokugcina (izinsuku)',
          'admin-retention-period-placeholder': '30',
          'admin-save-settings': 'Gcina Izilungiselelo',
          'admin-backup-history-management': 'Ulawulo lweMbali ye-Backup',
          'admin-recent-backups': 'I-Backups zakutshanje',
          'admin-refresh': 'Hlaziya',
          'admin-data-recovery-options': 'Izinketho zokuBuyisela iDatha',
          'admin-recovery-mode': 'Imo yokuBuyisela',
          'admin-merge-existing-data': 'Dibanisa neDatha ekhona',
          'admin-replace-all-data': 'Shintsha Zonke iDatha',
          'admin-selective-restore': 'Ukubuyisela okukhethiweyo',
          'admin-enable-verification': 'Vumela ukuQinisekisa',
          'admin-verify-data-integrity': 'Qinisekisa ukuthembeka kwedatha phambi kokubuyisela',
          'admin-verify-selected-backup': 'Qinisekisa i-Backup ekhethiweyo',
          'admin-emergency-restore': 'Ukubuyisela okuKhawulezayo',
          'admin-reset-to-defaults': 'Buyisela kwiNtandathu'
        }
      };

      // Global variable for language selector
      let adminLanguageSelect = null;

      function applyAdminLanguage() {
        try {
          const language = adminLanguageSelect?.value || 'en';
          const currentTranslations = adminTranslations[language] || adminTranslations.en;
          
          // Update all elements with data-translate attribute
          document.querySelectorAll('[data-translate]').forEach(element => {
            const key = element.getAttribute('data-translate');
            const translation = currentTranslations[key];
            if (translation) {
              element.textContent = translation;
            }
          });
          
          // Update option elements specifically
          document.querySelectorAll('option[data-translate]').forEach(option => {
            const key = option.getAttribute('data-translate');
            const translation = currentTranslations[key];
            if (translation) {
              option.textContent = translation;
            }
          });
          
          // Update placeholder attributes
          document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
            const key = element.getAttribute('data-translate-placeholder');
            const translation = currentTranslations[key];
            if (translation) {
              element.placeholder = translation;
            }
          });
          
          // Update page title
          document.title = currentTranslations['admin-sidebar-title'] || 'Admin Dashboard';
          
          // Update calendar if it's visible
          if (typeof adminRenderHeader === 'function') {
            adminRenderHeader();
          }
          if (typeof adminRenderWeekdays === 'function') {
            adminRenderWeekdays();
          }
          
        } catch (error) {
          console.error('Error applying admin language:', error);
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        const navItems = document.querySelectorAll('.lecturer-nav-item');
        const sections = document.querySelectorAll('.section');
        // Show dashboard by default
        sections.forEach(sec => { sec.style.display = sec.id === 'dashboard' ? 'block' : 'none'; });
        navItems.forEach(item => {
          item.addEventListener('click', (e) => {
            const target = item.getAttribute('data-target');
            if (!target || target === 'logout' || target === 'courses') return; // external or no-op
            e.preventDefault();
            sections.forEach(sec => { sec.style.display = (sec.id === target) ? 'block' : 'none'; });
            navItems.forEach(a => a.classList.remove('active'));
            item.classList.add('active');
            if (target === 'calendar') {
              console.log('Calendar section clicked, initializing calendar...');
              adminRenderCalendar();
            }
            if (target === 'users') adminRenderUsers();
            if (target === 'lecturers') adminRenderLecturers();
            if (target === 'students') adminRenderStudents();
            if (target === 'attendance') adminRenderAttendance();
            if (target === 'settings') adminLoadSettings();
          });
        });

        // Initialize language selector
        adminLanguageSelect = document.getElementById('admin-language-select');
        if (adminLanguageSelect) {
          // Load saved language preference
          const savedLanguage = localStorage.getItem('adminLanguage') || 'en';
          adminLanguageSelect.value = savedLanguage;
          
          // Apply initial language
          applyAdminLanguage();
          
          // Add event listener for language changes
          adminLanguageSelect.addEventListener('change', () => {
            localStorage.setItem('adminLanguage', adminLanguageSelect.value);
            applyAdminLanguage();
          });
        }

        // Initialize timezone system
        initializeTimezone();

        // ===== Admin Calendar Logic =====
        const ADM_WEEKDAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
        const admMonthName = document.getElementById('adm-calendar-month');
        const admPrevBtn = document.getElementById('adm-calendar-prev');
        const admNextBtn = document.getElementById('adm-calendar-next');
        const admWeekdaysEl = document.getElementById('adm-calendar-weekdays');
        const admDaysEl = document.getElementById('adm-calendar-days');
        const admSelectedDateLabel = document.getElementById('adm-selected-date-label');
        const admEventsDate = document.getElementById('adm-events-date');
        const admEventsList = document.getElementById('adm-events-list');

        const admFilterType = document.getElementById('adm-filter-type');
        const admFilterCourse = document.getElementById('adm-filter-course');
        const admFilterSearch = document.getElementById('adm-filter-search');
        const admFilterApply = document.getElementById('adm-filter-apply');

        const admEventId = document.getElementById('adm-event-id');
        const admEventTitle = document.getElementById('adm-event-title');
        const admEventTime = document.getElementById('adm-event-time');
        const admEventType = document.getElementById('adm-event-type');
        const admEventCourse = document.getElementById('adm-event-course');
        const admEventLecturer = document.getElementById('adm-event-lecturer');
        const admEventNotes = document.getElementById('adm-event-notes');
        const admEventSave = document.getElementById('adm-event-save');
        const admEventReset = document.getElementById('adm-event-reset');
        const admEventDelete = document.getElementById('adm-event-delete');

        const admExportJson = document.getElementById('adm-export-json');
        const admImportJson = document.getElementById('adm-import-json');
        const admImportFile = document.getElementById('adm-import-file');
        const admPrintBtn = document.getElementById('adm-print');
        const admClearAll = document.getElementById('adm-clear-all');

        let admCalendarCursor = new Date();
        admCalendarCursor.setDate(1);
        let admSelectedDate = null;

        function admPad2(n){ return n < 10 ? '0' + n : String(n); }
        function admFmtDate(d){ return `${d.getFullYear()}-${admPad2(d.getMonth()+1)}-${admPad2(d.getDate())}`; }
        function admParseStore(){ try { return JSON.parse(localStorage.getItem('adminCalendarEvents')||'{}'); } catch { return {}; } }
        function admWriteStore(obj){ localStorage.setItem('adminCalendarEvents', JSON.stringify(obj)); }

        function adminRenderWeekdays(){
          try {
            if (!admWeekdaysEl) {
              console.error('Admin calendar weekdays element not found');
              return;
            }
            
            admWeekdaysEl.innerHTML = '';
            const language = adminLanguageSelect?.value || 'en';
            const currentTranslations = adminTranslations[language] || adminTranslations.en;
            const dayKeys = [
              'admin-day-sunday', 'admin-day-monday', 'admin-day-tuesday', 'admin-day-wednesday',
              'admin-day-thursday', 'admin-day-friday', 'admin-day-saturday'
            ];
            dayKeys.forEach(dayKey => {
              const div = document.createElement('div');
              div.className = 'day';
              const translatedDay = currentTranslations[dayKey] || dayKey;
              div.textContent = translatedDay;
              admWeekdaysEl.appendChild(div);
            });
            console.log('Admin calendar weekdays rendered successfully');
          } catch (error) {
            console.error('Error rendering admin calendar weekdays:', error);
          }
        }

        function adminRenderDays(){
          try {
            if (!admDaysEl) {
              console.error('Admin calendar days element not found');
              return;
            }
            
            admDaysEl.innerHTML = '';
            const year = admCalendarCursor.getFullYear();
            const month = admCalendarCursor.getMonth();
            const firstDayIndex = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month+1, 0).getDate();
            const store = admParseStore();

          for (let i=0;i<firstDayIndex;i++){
            const div = document.createElement('div');
            div.className = 'day prev';
            admDaysEl.appendChild(div);
          }
          for (let d=1; d<=daysInMonth; d++){
            const dateObj = new Date(year, month, d);
            const dateStr = admFmtDate(dateObj);
            const div = document.createElement('div');
            div.className = 'day';
            div.textContent = String(d);
            const today = new Date();
            if (today.getFullYear()===year && today.getMonth()===month && today.getDate()===d){
              div.classList.add('today');
            }
            // Event indicator
            if (store[dateStr] && store[dateStr].length){
              const dot = document.createElement('span');
              dot.style.display='block';
              dot.style.width='6px';
              dot.style.height='6px';
              dot.style.background='#3498db';
              dot.style.borderRadius='50%';
              dot.style.margin='4px auto 0';
              div.appendChild(dot);
            }
            div.addEventListener('click', ()=>{
              admSelectedDate = dateStr;
              admSelectedDateLabel.textContent = `(${admSelectedDate})`;
              admEventsDate.textContent = admSelectedDate;
              adminRenderEvents();
            });
            admDaysEl.appendChild(div);
          }
          console.log('Admin calendar days rendered successfully');
          } catch (error) {
            console.error('Error rendering admin calendar days:', error);
          }
        }

        function adminRenderHeader(){
          try {
            const y = admCalendarCursor.getFullYear();
            const monthIndex = admCalendarCursor.getMonth();
            const language = adminLanguageSelect?.value || 'en';
            const currentTranslations = adminTranslations[language] || adminTranslations.en;
            const monthKeys = [
              'admin-month-january', 'admin-month-february', 'admin-month-march', 'admin-month-april',
              'admin-month-may', 'admin-month-june', 'admin-month-july', 'admin-month-august',
              'admin-month-september', 'admin-month-october', 'admin-month-november', 'admin-month-december'
            ];
            const translatedMonth = currentTranslations[monthKeys[monthIndex]] || monthKeys[monthIndex];
            
            if (admMonthName) {
              admMonthName.textContent = `${translatedMonth} ${y}`;
              console.log(`Admin calendar header updated: ${translatedMonth} ${y}`);
            } else {
              console.error('Admin calendar month element not found');
            }
          } catch (error) {
            console.error('Error rendering admin calendar header:', error);
          }
        }

        function adminRenderEvents(){
          const store = admParseStore();
          const list = store[admSelectedDate] || [];
          // Filters
          const typeFilter = admFilterType.value;
          const courseFilter = (admFilterCourse.value||'').trim().toLowerCase();
          const searchFilter = (admFilterSearch.value||'').trim().toLowerCase();
          const filtered = list.filter(ev =>
            (typeFilter==='all' || ev.type===typeFilter) &&
            (!courseFilter || (ev.course||'').toLowerCase().includes(courseFilter)) &&
            (!searchFilter || (ev.title+" "+(ev.notes||'')).toLowerCase().includes(searchFilter))
          );
          admEventsList.innerHTML = filtered.length ? '' : '<li>No events for this date.</li>';
          filtered.sort((a,b)=> (a.time||'').localeCompare(b.time||''));
          for (const ev of filtered){
            const li = document.createElement('li');
            li.innerHTML = `
              <strong>${ev.time ? ev.time+' - ' : ''}${ev.title}</strong>
              <div class="muted">${ev.type} ${ev.course ? ' ‚Ä¢ '+ev.course : ''} ${ev.lecturer ? ' ‚Ä¢ '+ev.lecturer : ''}</div>
              <div class="muted">${ev.notes||''}</div>
              <div style="margin-top:6px;display:flex;gap:8px;">
                <button class="btn btn-small" data-edit="${ev.id}">Edit</button>
                <button class="btn btn-small" data-del="${ev.id}">Delete</button>
              </div>`;
            admEventsList.appendChild(li);
          }
          // bind actions
          admEventsList.querySelectorAll('[data-edit]').forEach(btn => btn.addEventListener('click', () => adminLoadEvent(btn.getAttribute('data-edit'))));
          admEventsList.querySelectorAll('[data-del]').forEach(btn => btn.addEventListener('click', () => adminDeleteEvent(btn.getAttribute('data-del'))));
        }

        function adminLoadEvent(id){
          const store = admParseStore();
          const list = store[admSelectedDate] || [];
          const ev = list.find(e => e.id === id);
          if (!ev) return;
          admEventId.value = ev.id;
          admEventTitle.value = ev.title || '';
          admEventTime.value = ev.time || '';
          admEventType.value = ev.type || 'Other';
          admEventCourse.value = ev.course || '';
          admEventLecturer.value = ev.lecturer || '';
          admEventNotes.value = ev.notes || '';
        }

        function adminDeleteEvent(id){
          if (!admSelectedDate) return;
          const store = admParseStore();
          const list = store[admSelectedDate] || [];
          const next = list.filter(e => e.id !== id);
          store[admSelectedDate] = next;
          admWriteStore(store);
          adminRenderEvents();
        }

        function adminResetEventForm(){
          admEventId.value = '';
          admEventTitle.value = '';
          admEventTime.value = '';
          admEventType.value = 'Lecture';
          admEventCourse.value = '';
          admEventLecturer.value = '';
          admEventNotes.value = '';
        }

        function adminSaveEvent(){
          if (!admSelectedDate){ alert('Select a date on the calendar first.'); return; }
          const title = (admEventTitle.value||'').trim();
          if (!title){ alert('Please enter a title.'); return; }
          const time = (admEventTime.value||'').trim();
          const type = admEventType.value;
          const course = (admEventCourse.value||'').trim();
          const lecturer = (admEventLecturer.value||'').trim();
          const notes = (admEventNotes.value||'').trim();
          const store = admParseStore();
          const list = store[admSelectedDate] || [];
          const id = admEventId.value || `E${Date.now()}`;
          const existingIndex = list.findIndex(e => e.id === id);
          const payload = { 
            id, 
            title, 
            time, 
            type, 
            course, 
            lecturer, 
            notes, 
            isAdminEvent: true,
            createdBy: 'admin',
            createdAt: new Date().toISOString()
          };
          if (existingIndex >= 0) list[existingIndex] = payload; else list.push(payload);
          store[admSelectedDate] = list;
          admWriteStore(store);
          adminRenderDays();
          adminRenderEvents();
          adminResetEventForm();
        }

        // Import/Export/Print/Clear
        function adminExport(){
          const data = admParseStore();
          const blob = new Blob([JSON.stringify(data,null,2)], { type: 'application/json' });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `admin-calendar-${new Date().toISOString().slice(0,10)}.json`;
          a.click();
          URL.revokeObjectURL(a.href);
        }
        function adminImport(file){
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const obj = JSON.parse(String(reader.result||'{}'));
              admWriteStore(obj || {});
              adminRenderDays();
              if (admSelectedDate) adminRenderEvents();
            } catch {}
          };
          reader.readAsText(file);
        }
        function adminClear(){
          if (!confirm('Clear all admin calendar events?')) return;
          localStorage.removeItem('adminCalendarEvents');
          adminRenderDays();
          admEventsList.innerHTML = '<li>No events for this date.</li>';
        }

        function adminPrint(){
          window.print();
        }

        function adminRenderCalendar(){
          adminRenderHeader();
          adminRenderWeekdays();
          adminRenderDays();
        }

        admPrevBtn?.addEventListener('click', ()=>{ admCalendarCursor.setMonth(admCalendarCursor.getMonth()-1); adminRenderCalendar(); });
        admNextBtn?.addEventListener('click', ()=>{ admCalendarCursor.setMonth(admCalendarCursor.getMonth()+1); adminRenderCalendar(); });
        admFilterApply?.addEventListener('click', ()=>{ if (admSelectedDate) adminRenderEvents(); });
        admEventSave?.addEventListener('click', adminSaveEvent);
        admEventReset?.addEventListener('click', adminResetEventForm);
        admEventDelete?.addEventListener('click', ()=>{ if (admEventId.value) adminDeleteEvent(admEventId.value); });
        admExportJson?.addEventListener('click', adminExport);
        admImportJson?.addEventListener('click', ()=> admImportFile?.click());
        admImportFile?.addEventListener('change', (e)=>{ const f = e.target.files?.[0]; if (f) adminImport(f); e.target.value = ''; });
        admClearAll?.addEventListener('click', adminClear);
        admPrintBtn?.addEventListener('click', adminPrint);

        // If user lands on calendar directly by navigation, render it once
        if (document.getElementById('calendar')?.style.display === 'block') {
          console.log('Calendar section is visible on page load, initializing...');
          adminRenderCalendar();
        }

        // ===== Users Management =====
        const usersTbody = document.getElementById('users-tbody');
        const userFilterRole = document.getElementById('user-filter-role');
        const userFilterSearch = document.getElementById('user-filter-search');
        const userFilterApply = document.getElementById('user-filter-apply');
        const userExportBtn = document.getElementById('user-export');
        const userImportBtn = document.getElementById('user-import');
        const userImportFile = document.getElementById('user-import-file');

        const userIdInput = document.getElementById('user-id');
        const userNameInput = document.getElementById('user-name');
        const userEmailInput = document.getElementById('user-email');
        const userPasswordInput = document.getElementById('user-password');
        const userRoleSelect = document.getElementById('user-role');
        const userSaveBtn = document.getElementById('user-save');
        const userResetBtn = document.getElementById('user-reset');

        // Helper functions for courses management
        function loadCourses(){
          try { return JSON.parse(localStorage.getItem('courses')||'[]'); } catch { return []; }
        }
        function writeCourses(arr){ localStorage.setItem('courses', JSON.stringify(arr)); }

        function loadUsers(){
          try { return JSON.parse(localStorage.getItem('users')||'[]'); } catch { return []; }
        }
        function writeUsers(arr){ localStorage.setItem('users', JSON.stringify(arr)); }

        function adminRenderUsers(){
          const all = loadUsers();
          const role = userFilterRole?.value || 'all';
          const q = (userFilterSearch?.value||'').trim().toLowerCase();
          const filtered = all.filter(u =>
            (role==='all' || u.role===role) &&
            (!q || (u.name||'').toLowerCase().includes(q) || (u.email||'').toLowerCase().includes(q))
          );
          usersTbody.innerHTML = '';
          if (!filtered.length){
            const tr = document.createElement('tr');
            const td = document.createElement('td'); td.colSpan = 4; td.className = 'centered-cell'; td.textContent = 'No users found.';
            tr.appendChild(td); usersTbody.appendChild(tr); return;
          }
          filtered.forEach(u => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${u.name||''}</td>
              <td>${u.email||''}</td>
              <td>${u.role||''}</td>
              <td>
                <button class="btn btn-small" data-edit-user="${u.email}">Edit</button>
                <button class="btn btn-small" data-del-user="${u.email}">Delete</button>
              </td>`;
            usersTbody.appendChild(tr);
          });
          usersTbody.querySelectorAll('[data-edit-user]').forEach(btn => btn.addEventListener('click', ()=>{
            const email = btn.getAttribute('data-edit-user');
            const all = loadUsers();
            const u = all.find(x => x.email === email);
            if (!u) return;
            userIdInput.value = u.email; // use email as identifier
            userNameInput.value = u.name || '';
            userEmailInput.value = u.email || '';
            userPasswordInput.value = u.password || '';
            userRoleSelect.value = u.role || 'Student';
          }));
          usersTbody.querySelectorAll('[data-del-user]').forEach(btn => btn.addEventListener('click', ()=>{
            const email = btn.getAttribute('data-del-user');
            const all = loadUsers().filter(x => x.email !== email);
            writeUsers(all);
            adminRenderUsers();
            updateDashboardStats();
          }));
        }

        function userResetForm(){
          userIdInput.value = '';
          userNameInput.value = '';
          userEmailInput.value = '';
          userPasswordInput.value = '';
          userRoleSelect.value = 'Student';
        }

        function userSave(){
          const formData = {
            name: (userNameInput.value||'').trim(),
            email: (userEmailInput.value||'').trim(),
            password: (userPasswordInput.value||'').trim(),
            role: userRoleSelect.value
          };
          
          // Validate form data
          const validation = validationManager.validateForm(formData, 'user');
          if (!validation.isValid) {
            validationManager.showFormErrors(validation.errors);
            validationManager.showNotification('Please fix the errors before submitting.', 'error');
            return;
          }
          
          // Sanitize inputs
          const sanitizedData = {
            name: validationManager.sanitizeInput(formData.name),
            email: validationManager.sanitizeInput(formData.email),
            password: formData.password, // Don't sanitize password
            role: formData.role
          };
          
          try {
            const all = loadUsers();
            const existingIndex = all.findIndex(u => u.email === (userIdInput.value || sanitizedData.email));
            
            const payload = { 
              name: sanitizedData.name, 
              email: sanitizedData.email, 
              password: sanitizedData.password, 
              role: sanitizedData.role,
              updatedAt: new Date().toISOString()
            };
            
            if (existingIndex >= 0) {
              // Update existing user
              payload.id = all[existingIndex].id;
              payload.createdAt = all[existingIndex].createdAt || new Date().toISOString();
              payload.lastLogin = all[existingIndex].lastLogin;
              all[existingIndex] = payload;
              validationManager.showNotification('User updated successfully!', 'success');
            } else {
              // Add new user
              payload.id = Date.now();
              payload.createdAt = new Date().toISOString();
              payload.lastLogin = null;
              all.push(payload);
              validationManager.showNotification('User added successfully!', 'success');
            }
            
            writeUsers(all);
            adminRenderUsers();
            userResetForm();
            updateDashboardStats();
          } catch (error) {
            validationManager.handleGlobalError(error);
          }
        }

        function usersExport(){
          const data = loadUsers();
          const blob = new Blob([JSON.stringify(data,null,2)], { type: 'application/json' });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `users-${new Date().toISOString().slice(0,10)}.json`;
          a.click();
          URL.revokeObjectURL(a.href);
        }
        function usersImport(file){
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const arr = JSON.parse(String(reader.result||'[]'));
              if (Array.isArray(arr)) writeUsers(arr);
              adminRenderUsers();
            } catch {}
          };
          reader.readAsText(file);
        }

        userFilterApply?.addEventListener('click', adminRenderUsers);
        userSaveBtn?.addEventListener('click', userSave);
        userResetBtn?.addEventListener('click', userResetForm);
        userExportBtn?.addEventListener('click', usersExport);
        userImportBtn?.addEventListener('click', ()=> userImportFile?.click());
        userImportFile?.addEventListener('change', (e)=>{ const f=e.target.files?.[0]; if (f) usersImport(f); e.target.value=''; });

        // Render users once if users section is visible
        if (document.getElementById('users')?.style.display === 'block') adminRenderUsers();

        // ===== Lecturers Management =====
        const lecturersTbody = document.getElementById('lecturers-tbody');
        const lecturerFilterDept = document.getElementById('lecturer-filter-dept');
        const lecturerFilterSearch = document.getElementById('lecturer-filter-search');
        const lecturerFilterApply = document.getElementById('lecturer-filter-apply');
        const lecturerExportBtn = document.getElementById('lecturer-export');
        const lecturerImportBtn = document.getElementById('lecturer-import');
        const lecturerImportFile = document.getElementById('lecturer-import-file');

        const lecturerIdInput = document.getElementById('lecturer-id');
        const lecturerNameInput = document.getElementById('lecturer-name');
        const lecturerEmailInput = document.getElementById('lecturer-email');
        const lecturerPasswordInput = document.getElementById('lecturer-password');
        const lecturerDeptSelect = document.getElementById('lecturer-dept');
        const lecturerOfficeInput = document.getElementById('lecturer-office');
        const lecturerPhoneInput = document.getElementById('lecturer-phone');
        const lecturerBioInput = document.getElementById('lecturer-bio');
        const lecturerSaveBtn = document.getElementById('lecturer-save');
        const lecturerResetBtn = document.getElementById('lecturer-reset');

        function loadLecturers(){
          try { return JSON.parse(localStorage.getItem('lecturers')||'[]'); } catch { return []; }
        }
        function writeLecturers(arr){ localStorage.setItem('lecturers', JSON.stringify(arr)); }

        function adminRenderLecturers(){
          const all = loadLecturers();
          const dept = lecturerFilterDept?.value || 'all';
          const q = (lecturerFilterSearch?.value||'').trim().toLowerCase();
          const filtered = all.filter(l =>
            (dept==='all' || l.department===dept) &&
            (!q || (l.name||'').toLowerCase().includes(q) || (l.email||'').toLowerCase().includes(q))
          );
          lecturersTbody.innerHTML = '';
          if (!filtered.length){
            const tr = document.createElement('tr');
            const td = document.createElement('td'); td.colSpan = 6; td.className = 'centered-cell'; td.textContent = 'No lecturers found.';
            tr.appendChild(td); lecturersTbody.appendChild(tr); return;
          }
          filtered.forEach(l => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${l.name||''}</td>
              <td>${l.email||''}</td>
              <td>${l.department||''}</td>
              <td>${l.office||''}</td>
              <td>${l.phone||''}</td>
              <td>
                <button class="btn btn-small" data-edit-lecturer="${l.email}">Edit</button>
                <button class="btn btn-small" data-del-lecturer="${l.email}">Delete</button>
              </td>`;
            lecturersTbody.appendChild(tr);
          });
          lecturersTbody.querySelectorAll('[data-edit-lecturer]').forEach(btn => btn.addEventListener('click', ()=>{
            const email = btn.getAttribute('data-edit-lecturer');
            const all = loadLecturers();
            const l = all.find(x => x.email === email);
            if (!l) return;
            lecturerIdInput.value = l.email;
            lecturerNameInput.value = l.name || '';
            lecturerEmailInput.value = l.email || '';
            lecturerPasswordInput.value = l.password || '';
            lecturerDeptSelect.value = l.department || 'Computer Science';
            lecturerOfficeInput.value = l.office || '';
            lecturerPhoneInput.value = l.phone || '';
            lecturerBioInput.value = l.bio || '';
          }));
          lecturersTbody.querySelectorAll('[data-del-lecturer]').forEach(btn => btn.addEventListener('click', ()=>{
            const email = btn.getAttribute('data-del-lecturer');
            const all = loadLecturers().filter(x => x.email !== email);
            writeLecturers(all);
            adminRenderLecturers();
            updateDashboardStats();
          }));
        }

        function lecturerResetForm(){
          lecturerIdInput.value = '';
          lecturerNameInput.value = '';
          lecturerEmailInput.value = '';
          lecturerPasswordInput.value = '';
          lecturerDeptSelect.value = 'Computer Science';
          lecturerOfficeInput.value = '';
          lecturerPhoneInput.value = '';
          lecturerBioInput.value = '';
        }

        function lecturerSave(){
          const formData = {
            name: (lecturerNameInput.value||'').trim(),
            email: (lecturerEmailInput.value||'').trim(),
            password: (lecturerPasswordInput.value||'').trim(),
            department: lecturerDeptSelect.value,
            office: (lecturerOfficeInput.value||'').trim(),
            phone: (lecturerPhoneInput.value||'').trim(),
            bio: (lecturerBioInput.value||'').trim()
          };
          
          // Validate form data
          const validation = validationManager.validateForm(formData, 'lecturer');
          if (!validation.isValid) {
            validationManager.showFormErrors(validation.errors);
            validationManager.showNotification('Please fix the errors before submitting.', 'error');
            return;
          }
          
          // Sanitize inputs
          const sanitizedData = {
            name: validationManager.sanitizeInput(formData.name),
            email: validationManager.sanitizeInput(formData.email),
            password: formData.password, // Don't sanitize password
            department: formData.department,
            office: validationManager.sanitizeInput(formData.office),
            phone: validationManager.sanitizeInput(formData.phone),
            bio: validationManager.sanitizeInput(formData.bio)
          };
          
          try {
            const all = loadLecturers();
            const existingIndex = all.findIndex(l => l.email === (lecturerIdInput.value || sanitizedData.email));
            
            const payload = { 
              name: sanitizedData.name, 
              email: sanitizedData.email, 
              password: sanitizedData.password, 
              department: sanitizedData.department,
              office: sanitizedData.office,
              phone: sanitizedData.phone,
              bio: sanitizedData.bio,
              updatedAt: new Date().toISOString()
            };
            
            if (existingIndex >= 0) {
              // Update existing lecturer
              payload.id = all[existingIndex].id;
              payload.createdAt = all[existingIndex].createdAt || new Date().toISOString();
              payload.lastLogin = all[existingIndex].lastLogin;
              all[existingIndex] = payload;
              validationManager.showNotification('Lecturer updated successfully!', 'success');
            } else {
              // Add new lecturer
              payload.id = Date.now();
              payload.createdAt = new Date().toISOString();
              payload.lastLogin = null;
              all.push(payload);
              validationManager.showNotification('Lecturer added successfully!', 'success');
            }
            
            writeLecturers(all);
            adminRenderLecturers();
            lecturerResetForm();
            updateDashboardStats();
          } catch (error) {
            validationManager.handleGlobalError(error);
          }
        }

        function lecturersExport(){
          const data = loadLecturers();
          const blob = new Blob([JSON.stringify(data,null,2)], { type: 'application/json' });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `lecturers-${new Date().toISOString().slice(0,10)}.json`;
          a.click();
          URL.revokeObjectURL(a.href);
        }
        function lecturersImport(file){
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const arr = JSON.parse(String(reader.result||'[]'));
              if (Array.isArray(arr)) writeLecturers(arr);
              adminRenderLecturers();
            } catch {}
          };
          reader.readAsText(file);
        }

        lecturerFilterApply?.addEventListener('click', adminRenderLecturers);
        lecturerSaveBtn?.addEventListener('click', lecturerSave);
        lecturerResetBtn?.addEventListener('click', lecturerResetForm);
        lecturerExportBtn?.addEventListener('click', lecturersExport);
        lecturerImportBtn?.addEventListener('click', ()=> lecturerImportFile?.click());
        lecturerImportFile?.addEventListener('change', (e)=>{ const f=e.target.files?.[0]; if (f) lecturersImport(f); e.target.value=''; });

        // ===== Students Management =====
        const studentsTbody = document.getElementById('students-tbody');
        const studentFilterYear = document.getElementById('student-filter-year');
        const studentFilterCourse = document.getElementById('student-filter-course');
        const studentFilterSearch = document.getElementById('student-filter-search');
        const studentFilterApply = document.getElementById('student-filter-apply');
        const studentExportBtn = document.getElementById('student-export');
        const studentImportBtn = document.getElementById('student-import');
        const studentImportFile = document.getElementById('student-import-file');

        const studentIdInput = document.getElementById('student-id');
        const studentNameInput = document.getElementById('student-name');
        const studentEmailInput = document.getElementById('student-email');
        const studentPasswordInput = document.getElementById('student-password');
        const studentYearSelect = document.getElementById('student-year');
        const studentCourseInput = document.getElementById('student-course');
        const studentIdNumInput = document.getElementById('student-id-num');
        const studentSaveBtn = document.getElementById('student-save');
        const studentResetBtn = document.getElementById('student-reset');

        function loadStudents(){
          try { return JSON.parse(localStorage.getItem('students')||'[]'); } catch { return []; }
        }
        function writeStudents(arr){ localStorage.setItem('students', JSON.stringify(arr)); }

        function adminRenderStudents(){
          const all = loadStudents();
          const year = studentFilterYear?.value || 'all';
          const course = (studentFilterCourse?.value||'').trim().toLowerCase();
          const q = (studentFilterSearch?.value||'').trim().toLowerCase();
          const filtered = all.filter(s =>
            (year==='all' || s.year===year) &&
            (!course || (s.course||'').toLowerCase().includes(course)) &&
            (!q || (s.name||'').toLowerCase().includes(q) || (s.email||'').toLowerCase().includes(q))
          );
          studentsTbody.innerHTML = '';
          if (!filtered.length){
            const tr = document.createElement('tr');
            const td = document.createElement('td'); td.colSpan = 6; td.className = 'centered-cell'; td.textContent = 'No students found.';
            tr.appendChild(td); studentsTbody.appendChild(tr); return;
          }
          filtered.forEach(s => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${s.name||''}</td>
              <td>${s.email||''}</td>
              <td>${s.year||''}</td>
              <td>${s.course||''}</td>
              <td>${s.studentId||''}</td>
              <td>
                <button class="btn btn-small" data-edit-student="${s.email}">Edit</button>
                <button class="btn btn-small" data-del-student="${s.email}">Delete</button>
              </td>`;
            studentsTbody.appendChild(tr);
          });
          studentsTbody.querySelectorAll('[data-edit-student]').forEach(btn => btn.addEventListener('click', ()=>{
            const email = btn.getAttribute('data-edit-student');
            const all = loadStudents();
            const s = all.find(x => x.email === email);
            if (!s) return;
            studentIdInput.value = s.email;
            studentNameInput.value = s.name || '';
            studentEmailInput.value = s.email || '';
            studentPasswordInput.value = s.password || '';
            studentYearSelect.value = s.year || '1';
            studentCourseInput.value = s.course || '';
            studentIdNumInput.value = s.studentId || '';
          }));
          studentsTbody.querySelectorAll('[data-del-student]').forEach(btn => btn.addEventListener('click', ()=>{
            const email = btn.getAttribute('data-del-student');
            const all = loadStudents().filter(x => x.email !== email);
            writeStudents(all);
            adminRenderStudents();
            updateDashboardStats();
          }));
        }

        function studentResetForm(){
          studentIdInput.value = '';
          studentNameInput.value = '';
          studentEmailInput.value = '';
          studentPasswordInput.value = '';
          studentYearSelect.value = '1';
          studentCourseInput.value = '';
          studentIdNumInput.value = '';
        }

        function studentSave(){
          const formData = {
            name: (studentNameInput.value||'').trim(),
            email: (studentEmailInput.value||'').trim(),
            password: (studentPasswordInput.value||'').trim(),
            year: studentYearSelect.value,
            course: (studentCourseInput.value||'').trim(),
            studentId: (studentIdNumInput.value||'').trim()
          };
          
          // Validate form data
          const validation = validationManager.validateForm(formData, 'student');
          if (!validation.isValid) {
            validationManager.showFormErrors(validation.errors);
            validationManager.showNotification('Please fix the errors before submitting.', 'error');
            return;
          }
          
          // Sanitize inputs
          const sanitizedData = {
            name: validationManager.sanitizeInput(formData.name),
            email: validationManager.sanitizeInput(formData.email),
            password: formData.password, // Don't sanitize password
            year: formData.year,
            course: validationManager.sanitizeInput(formData.course),
            studentId: validationManager.sanitizeInput(formData.studentId)
          };
          
          try {
            const all = loadStudents();
            const existingIndex = all.findIndex(s => s.email === (studentIdInput.value || sanitizedData.email));
            
            const payload = { 
              name: sanitizedData.name, 
              email: sanitizedData.email, 
              password: sanitizedData.password, 
              year: sanitizedData.year,
              course: sanitizedData.course,
              studentId: sanitizedData.studentId,
              updatedAt: new Date().toISOString()
            };
            
            if (existingIndex >= 0) {
              // Update existing student
              payload.id = all[existingIndex].id;
              payload.createdAt = all[existingIndex].createdAt || new Date().toISOString();
              payload.lastLogin = all[existingIndex].lastLogin;
              all[existingIndex] = payload;
              validationManager.showNotification('Student updated successfully!', 'success');
            } else {
              // Add new student
              payload.id = Date.now();
              payload.createdAt = new Date().toISOString();
              payload.lastLogin = null;
              all.push(payload);
              validationManager.showNotification('Student added successfully!', 'success');
            }
            
            writeStudents(all);
            adminRenderStudents();
            studentResetForm();
            updateDashboardStats();
          } catch (error) {
            validationManager.handleGlobalError(error);
          }
        }

        function studentsExport(){
          const data = loadStudents();
          const blob = new Blob([JSON.stringify(data,null,2)], { type: 'application/json' });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `students-${new Date().toISOString().slice(0,10)}.json`;
          a.click();
          URL.revokeObjectURL(a.href);
        }
        function studentsImport(file){
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const arr = JSON.parse(String(reader.result||'[]'));
              if (Array.isArray(arr)) writeStudents(arr);
              adminRenderStudents();
            } catch {}
          };
          reader.readAsText(file);
        }

        studentFilterApply?.addEventListener('click', adminRenderStudents);
        studentSaveBtn?.addEventListener('click', studentSave);
        studentResetBtn?.addEventListener('click', studentResetForm);
        studentExportBtn?.addEventListener('click', studentsExport);
        studentImportBtn?.addEventListener('click', ()=> studentImportFile?.click());
        studentImportFile?.addEventListener('change', (e)=>{ const f=e.target.files?.[0]; if (f) studentsImport(f); e.target.value=''; });

        // Render sections once if visible
        if (document.getElementById('lecturers')?.style.display === 'block') adminRenderLecturers();
        if (document.getElementById('students')?.style.display === 'block') adminRenderStudents();

        // ===== Attendance Management =====
        const attFilterDateFrom = document.getElementById('att-filter-date-from');
        const attFilterDateTo = document.getElementById('att-filter-date-to');
        const attFilterCourse = document.getElementById('att-filter-course');
        const attFilterLecturer = document.getElementById('att-filter-lecturer');
        const attFilterApply = document.getElementById('att-filter-apply');
        const attExportBtn = document.getElementById('att-export');
        const attendanceTbody = document.getElementById('attendance-tbody');
        const totalSessionsEl = document.getElementById('total-sessions');
        const presentStudentsEl = document.getElementById('present-students');
        const absentStudentsEl = document.getElementById('absent-students');
        const attendanceRateEl = document.getElementById('attendance-rate');
        const reportTypeSelect = document.getElementById('report-type');
        const reportFormatSelect = document.getElementById('report-format');
        const generateReportBtn = document.getElementById('generate-report');

        function loadAttendanceData(){
          try { return JSON.parse(localStorage.getItem('lecturerSessions')||'[]'); } catch { return []; }
        }

        function populateAttendanceFilters(){
          const courses = loadCourses();
          const lecturers = loadLecturers();
          
          attFilterCourse.innerHTML = '<option value="all">All Courses</option>';
          courses.forEach(c => {
            const opt = document.createElement('option');
            opt.value = c.code;
            opt.textContent = c.code;
            attFilterCourse.appendChild(opt);
          });

          attFilterLecturer.innerHTML = '<option value="all">All Lecturers</option>';
          lecturers.forEach(l => {
            const opt = document.createElement('option');
            opt.value = l.email;
            opt.textContent = l.name;
            attFilterLecturer.appendChild(opt);
          });
        }

        function adminRenderAttendance(){
          const sessions = loadAttendanceData();
          const from = attFilterDateFrom?.value || '';
          const to = attFilterDateTo?.value || '';
          const course = attFilterCourse?.value || 'all';
          const lecturer = attFilterLecturer?.value || 'all';
          
          const filtered = sessions.filter(s => {
            if (from && s.date < from) return false;
            if (to && s.date > to) return false;
            if (course !== 'all' && s.course !== course) return false;
            if (lecturer !== 'all' && s.lecturer !== lecturer) return false;
            return true;
          });

          // Update stats
          totalSessionsEl.textContent = filtered.length;
          const totalPresent = filtered.reduce((sum, s) => sum + (s.presentCount || 0), 0);
          const totalAbsent = filtered.reduce((sum, s) => sum + (s.absentCount || 0), 0);
          presentStudentsEl.textContent = totalPresent;
          absentStudentsEl.textContent = totalAbsent;
          const rate = totalPresent + totalAbsent > 0 ? Math.round((totalPresent / (totalPresent + totalAbsent)) * 100) : 0;
          attendanceRateEl.textContent = rate + '%';

          // Render table
          attendanceTbody.innerHTML = '';
          if (!filtered.length){
            const tr = document.createElement('tr');
            const td = document.createElement('td'); td.colSpan = 8; td.className = 'centered-cell'; td.textContent = 'No attendance records found.';
            tr.appendChild(td); attendanceTbody.appendChild(tr); return;
          }

          filtered.forEach(s => {
            const tr = document.createElement('tr');
            const present = s.presentCount || 0;
            const absent = s.absentCount || 0;
            const rate = present + absent > 0 ? Math.round((present / (present + absent)) * 100) : 0;
            tr.innerHTML = `
              <td>${s.date || ''}</td>
              <td>${s.course || ''}</td>
              <td>${s.lecturer || ''}</td>
              <td>${s.id || ''}</td>
              <td>${present}</td>
              <td>${absent}</td>
              <td>${rate}%</td>
              <td>
                <button class="btn btn-small" data-view-session="${s.id}">View</button>
              </td>`;
            attendanceTbody.appendChild(tr);
          });
        }

        function exportAttendanceReport(){
          try {
            const sessions = loadAttendanceData();
            const dateFrom = attFilterDateFrom?.value;
            const dateTo = attFilterDateTo?.value;
            const courseFilter = attFilterCourse?.value;
            const lecturerFilter = attFilterLecturer?.value;
            
            // Filter sessions based on current filters
            let filteredSessions = sessions;
            
            if (dateFrom) {
              filteredSessions = filteredSessions.filter(s => 
                new Date(s.date) >= new Date(dateFrom)
              );
            }
            
            if (dateTo) {
              filteredSessions = filteredSessions.filter(s => 
                new Date(s.date) <= new Date(dateTo)
              );
            }
            
            if (courseFilter && courseFilter !== 'all') {
              filteredSessions = filteredSessions.filter(s => 
                s.course === courseFilter
              );
            }
            
            if (lecturerFilter && lecturerFilter !== 'all') {
              filteredSessions = filteredSessions.filter(s => 
                s.lecturer === lecturerFilter
              );
            }
            
            // Calculate summary statistics
            const totalSessions = filteredSessions.length;
            const totalPresent = filteredSessions.reduce((sum, s) => sum + (s.presentCount || 0), 0);
            const totalAbsent = filteredSessions.reduce((sum, s) => sum + (s.absentCount || 0), 0);
            const attendanceRate = totalSessions > 0 ? ((totalPresent / (totalPresent + totalAbsent)) * 100).toFixed(1) : 0;
            
            const data = {
              exportDate: new Date().toISOString(),
              exportType: 'Attendance Report',
              filters: {
                dateFrom: dateFrom || 'All dates',
                dateTo: dateTo || 'All dates',
                course: courseFilter === 'all' ? 'All courses' : courseFilter,
                lecturer: lecturerFilter === 'all' ? 'All lecturers' : lecturerFilter
              },
              summary: {
                totalSessions: totalSessions,
                totalPresent: totalPresent,
                totalAbsent: totalAbsent,
                attendanceRate: `${attendanceRate}%`
              },
              sessions: filteredSessions.map(session => ({
                date: session.date,
                course: session.course,
                lecturer: session.lecturer,
                sessionTitle: session.title || 'Session',
                presentCount: session.presentCount || 0,
                absentCount: session.absentCount || 0,
                totalStudents: (session.presentCount || 0) + (session.absentCount || 0),
                attendanceRate: session.totalStudents > 0 ? 
                  (((session.presentCount || 0) / session.totalStudents) * 100).toFixed(1) + '%' : '0%'
              }))
            };
            
            // Create and download JSON file
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `attendance-report-${new Date().toISOString().slice(0,10)}.json`;
            a.click();
            URL.revokeObjectURL(a.href);
            
            // Show success message
            alert(`Attendance report exported successfully!\n\nSummary:\n- Total Sessions: ${totalSessions}\n- Present Students: ${totalPresent}\n- Absent Students: ${totalAbsent}\n- Attendance Rate: ${attendanceRate}%`);
            
          } catch (error) {
            console.error('Error exporting attendance report:', error);
            alert('Error exporting attendance report. Please try again.');
          }
        }

        function generateReport(){
          try {
            const type = reportTypeSelect?.value || 'summary';
            const format = reportFormatSelect?.value || 'pdf';
            const sessions = loadAttendanceData();
            
            // Apply current filters
            const dateFrom = attFilterDateFrom?.value;
            const dateTo = attFilterDateTo?.value;
            const courseFilter = attFilterCourse?.value;
            const lecturerFilter = attFilterLecturer?.value;
            
            let filteredSessions = sessions;
            
            if (dateFrom) {
              filteredSessions = filteredSessions.filter(s => 
                new Date(s.date) >= new Date(dateFrom)
              );
            }
            
            if (dateTo) {
              filteredSessions = filteredSessions.filter(s => 
                new Date(s.date) <= new Date(dateTo)
              );
            }
            
            if (courseFilter && courseFilter !== 'all') {
              filteredSessions = filteredSessions.filter(s => 
                s.course === courseFilter
              );
            }
            
            if (lecturerFilter && lecturerFilter !== 'all') {
              filteredSessions = filteredSessions.filter(s => 
                s.lecturer === lecturerFilter
              );
            }
            
            // Calculate statistics
            const totalSessions = filteredSessions.length;
            const totalPresent = filteredSessions.reduce((sum, s) => sum + (s.presentCount || 0), 0);
            const totalAbsent = filteredSessions.reduce((sum, s) => sum + (s.absentCount || 0), 0);
            const attendanceRate = totalSessions > 0 ? ((totalPresent / (totalPresent + totalAbsent)) * 100).toFixed(1) : 0;
            
            // Generate report based on type and format
            switch (format) {
              case 'csv':
                generateCSVReport(type, filteredSessions, {
                  totalSessions, totalPresent, totalAbsent, attendanceRate,
                  dateFrom, dateTo, courseFilter, lecturerFilter
                });
                break;
              case 'excel':
                generateExcelReport(type, filteredSessions, {
                  totalSessions, totalPresent, totalAbsent, attendanceRate,
                  dateFrom, dateTo, courseFilter, lecturerFilter
                });
                break;
              case 'pdf':
              default:
                generatePDFReport(type, filteredSessions, {
                  totalSessions, totalPresent, totalAbsent, attendanceRate,
                  dateFrom, dateTo, courseFilter, lecturerFilter
                });
                break;
            }
            
          } catch (error) {
            console.error('Error generating report:', error);
            alert('Error generating report. Please try again.');
          }
        }

        // Generate CSV Report
        function generateCSVReport(type, sessions, stats) {
          let csvContent = '';
          
          if (type === 'summary') {
            csvContent = `Attendance Summary Report\n`;
            csvContent += `Generated: ${new Date().toLocaleDateString()}\n`;
            csvContent += `Date Range: ${stats.dateFrom || 'All dates'} to ${stats.dateTo || 'All dates'}\n`;
            csvContent += `Course: ${stats.courseFilter === 'all' ? 'All courses' : stats.courseFilter}\n`;
            csvContent += `Lecturer: ${stats.lecturerFilter === 'all' ? 'All lecturers' : stats.lecturerFilter}\n\n`;
            csvContent += `Total Sessions,Total Present,Total Absent,Attendance Rate\n`;
            csvContent += `${stats.totalSessions},${stats.totalPresent},${stats.totalAbsent},${stats.attendanceRate}%\n`;
          } else {
            csvContent = `Date,Course,Lecturer,Session,Present,Absent,Total,Attendance Rate\n`;
            sessions.forEach(session => {
              const total = (session.presentCount || 0) + (session.absentCount || 0);
              const rate = total > 0 ? (((session.presentCount || 0) / total) * 100).toFixed(1) : 0;
              csvContent += `${session.date},${session.course},${session.lecturer},${session.title || 'Session'},${session.presentCount || 0},${session.absentCount || 0},${total},${rate}%\n`;
            });
          }
          
          const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `attendance-${type}-report-${new Date().toISOString().slice(0,10)}.csv`;
          a.click();
          URL.revokeObjectURL(a.href);
          
          alert(`CSV ${type} report generated successfully!`);
        }

        // Generate Excel Report (as CSV with Excel extension)
        function generateExcelReport(type, sessions, stats) {
          // For now, generate as CSV with .xlsx extension
          // In a real implementation, you would use a library like SheetJS
          generateCSVReport(type, sessions, stats);
          
          // Rename the downloaded file to .xlsx
          setTimeout(() => {
            alert(`Excel ${type} report generated successfully!\nNote: This is a CSV file with .xlsx extension. For full Excel support, integrate a library like SheetJS.`);
          }, 100);
        }

        // Generate PDF Report
        function generatePDFReport(type, sessions, stats) {
          // Create a simple HTML report that can be printed as PDF
          const reportWindow = window.open('', '_blank');
          const reportContent = `
            <!DOCTYPE html>
            <html>
            <head>
              <title>Attendance ${type.charAt(0).toUpperCase() + type.slice(1)} Report</title>
              <style>
                body { font-family: Arial, sans-serif; margin: 20px; }
                .header { text-align: center; margin-bottom: 30px; }
                .summary { background: #f5f5f5; padding: 15px; margin: 20px 0; border-radius: 5px; }
                .stats { display: flex; justify-content: space-around; margin: 20px 0; }
                .stat { text-align: center; }
                .stat-value { font-size: 24px; font-weight: bold; color: #2c3e50; }
                .stat-label { color: #7f8c8d; }
                table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                th { background-color: #3498db; color: white; }
                .footer { margin-top: 30px; text-align: center; color: #7f8c8d; }
                @media print { body { margin: 0; } }
              </style>
            </head>
            <body>
              <div class="header">
                <h1>Attendance ${type.charAt(0).toUpperCase() + type.slice(1)} Report</h1>
                <p>Generated on: ${new Date().toLocaleDateString()}</p>
              </div>
              
              <div class="summary">
                <h3>Report Filters</h3>
                <p><strong>Date Range:</strong> ${stats.dateFrom || 'All dates'} to ${stats.dateTo || 'All dates'}</p>
                <p><strong>Course:</strong> ${stats.courseFilter === 'all' ? 'All courses' : stats.courseFilter}</p>
                <p><strong>Lecturer:</strong> ${stats.lecturerFilter === 'all' ? 'All lecturers' : stats.lecturerFilter}</p>
              </div>
              
              <div class="stats">
                <div class="stat">
                  <div class="stat-value">${stats.totalSessions}</div>
                  <div class="stat-label">Total Sessions</div>
                </div>
                <div class="stat">
                  <div class="stat-value">${stats.totalPresent}</div>
                  <div class="stat-label">Present Students</div>
                </div>
                <div class="stat">
                  <div class="stat-value">${stats.totalAbsent}</div>
                  <div class="stat-label">Absent Students</div>
                </div>
                <div class="stat">
                  <div class="stat-value">${stats.attendanceRate}%</div>
                  <div class="stat-label">Attendance Rate</div>
                </div>
              </div>
              
              ${type !== 'summary' ? `
                <table>
                  <thead>
                    <tr>
                      <th>Date</th>
                      <th>Course</th>
                      <th>Lecturer</th>
                      <th>Session</th>
                      <th>Present</th>
                      <th>Absent</th>
                      <th>Total</th>
                      <th>Rate</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${sessions.map(session => {
                      const total = (session.presentCount || 0) + (session.absentCount || 0);
                      const rate = total > 0 ? (((session.presentCount || 0) / total) * 100).toFixed(1) : 0;
                      return `
                        <tr>
                          <td>${session.date}</td>
                          <td>${session.course}</td>
                          <td>${session.lecturer}</td>
                          <td>${session.title || 'Session'}</td>
                          <td>${session.presentCount || 0}</td>
                          <td>${session.absentCount || 0}</td>
                          <td>${total}</td>
                          <td>${rate}%</td>
                        </tr>
                      `;
                    }).join('')}
                  </tbody>
                </table>
              ` : ''}
              
              <div class="footer">
                <p>Report generated by Admin Dashboard</p>
              </div>
            </body>
            </html>
          `;
          
          reportWindow.document.write(reportContent);
          reportWindow.document.close();
          
          // Auto-print for PDF generation
          setTimeout(() => {
            reportWindow.print();
          }, 500);
          
          alert(`PDF ${type} report generated successfully!\nThe report will open in a new window for printing.`);
        }

        // ===== Settings Management =====
        const defaultSessionDuration = document.getElementById('default-session-duration');
        const attendanceThreshold = document.getElementById('attendance-threshold');
        const autoArchiveDays = document.getElementById('auto-archive-days');
        const timezoneSelect = document.getElementById('timezone');
        const notifLowAttendance = document.getElementById('notif-low-attendance');
        const notifSessionExpiry = document.getElementById('notif-session-expiry');
        const notifSystemUpdates = document.getElementById('notif-system-updates');
        const adminEmail = document.getElementById('admin-email');
        const notificationFrequency = document.getElementById('notification-frequency');
        const currentAdminPassword = document.getElementById('current-admin-password');
        const newAdminPassword = document.getElementById('new-admin-password');
        const confirmAdminPassword = document.getElementById('confirm-admin-password');
        const sessionTimeout = document.getElementById('session-timeout');
        const saveSettingsBtn = document.getElementById('save-settings');
        const resetSettingsBtn = document.getElementById('reset-settings');
        const backupDataBtn = document.getElementById('backup-data');
        const restoreDataBtn = document.getElementById('restore-data');
        const restoreFile = document.getElementById('restore-file');
        const clearAllDataBtn = document.getElementById('clear-all-data');
        const exportAllBtn = document.getElementById('export-all');

        function loadAdminSettings(){
          try { return JSON.parse(localStorage.getItem('adminSettings')||'{}'); } catch { return {}; }
        }
        function saveAdminSettings(settings){ localStorage.setItem('adminSettings', JSON.stringify(settings)); }

        function adminLoadSettings(){
          const settings = loadAdminSettings();
          defaultSessionDuration.value = settings.defaultSessionDuration || 15;
          attendanceThreshold.value = settings.attendanceThreshold || 75;
          autoArchiveDays.value = settings.autoArchiveDays || 90;
          
          // Initialize timezone with auto-detection
          const detectedTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
          timezoneSelect.value = settings.timezone || detectedTimezone || 'Africa/Johannesburg';
          
          notifLowAttendance.checked = settings.notifLowAttendance !== false;
          notifSessionExpiry.checked = settings.notifSessionExpiry !== false;
          notifSystemUpdates.checked = settings.notifSystemUpdates !== false;
          adminEmail.value = settings.adminEmail || '';
          notificationFrequency.value = settings.notificationFrequency || 'daily';
          sessionTimeout.value = settings.sessionTimeout || 30;
        }

        function saveSettings(){
          const settings = {
            defaultSessionDuration: Number(defaultSessionDuration.value) || 15,
            attendanceThreshold: Number(attendanceThreshold.value) || 75,
            autoArchiveDays: Number(autoArchiveDays.value) || 90,
            timezone: timezoneSelect.value,
            notifLowAttendance: notifLowAttendance.checked,
            notifSessionExpiry: notifSessionExpiry.checked,
            notifSystemUpdates: notifSystemUpdates.checked,
            adminEmail: adminEmail.value.trim(),
            notificationFrequency: notificationFrequency.value,
            sessionTimeout: Number(sessionTimeout.value) || 30
          };
          saveAdminSettings(settings);
          alert('Settings saved successfully!');
        }

        function resetSettings(){
          if (confirm('Reset all settings to defaults?')){
            localStorage.removeItem('adminSettings');
            adminLoadSettings();
            alert('Settings reset to defaults!');
          }
        }

        // Timezone change handler
        function handleTimezoneChange(){
          const newTimezone = timezoneSelect.value;
          const currentSettings = loadAdminSettings();
          currentSettings.timezone = newTimezone;
          saveAdminSettings(currentSettings);
          
          // Update any time-dependent displays
          updateTimeDisplays();
          
          // Show confirmation
          console.log(`Timezone changed to: ${newTimezone}`);
        }

        // Update time displays based on current timezone
        function updateTimeDisplays(){
          const timezone = timezoneSelect.value;
          const now = new Date();
          
          // Update any time-dependent elements
          const timeElements = document.querySelectorAll('[data-timezone]');
          timeElements.forEach(element => {
            try {
              const timeString = now.toLocaleString('en-US', {
                timeZone: timezone,
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
              });
              element.textContent = timeString;
            } catch (error) {
              console.warn('Error updating time display:', error);
            }
          });
        }

        // Initialize timezone system
        function initializeTimezone(){
          try {
            // Auto-detect user's timezone if not already set
            const detectedTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const currentSettings = loadAdminSettings();
            
            if (!currentSettings.timezone) {
              // Set detected timezone as default
              currentSettings.timezone = detectedTimezone;
              saveAdminSettings(currentSettings);
              console.log(`Auto-detected timezone: ${detectedTimezone}`);
            }
            
            // Load settings (which will use the detected timezone if none was saved)
            adminLoadSettings();
            
            // Update time displays
            updateTimeDisplays();
            
            // Set up periodic time updates (every minute)
            setInterval(updateTimeDisplays, 60000);
            
            console.log('Timezone system initialized successfully');
          } catch (error) {
            console.error('Error initializing timezone system:', error);
            // Fallback to default timezone
            timezoneSelect.value = 'Africa/Johannesburg';
          }
        }

        // Enhanced Backup & Recovery System
        class BackupManager {
          constructor() {
            this.backupSettings = this.loadBackupSettings();
            this.backupHistory = this.loadBackupHistory();
            this.init();
          }

          init() {
            this.setupEventListeners();
            this.startAutoBackup();
            this.renderBackupHistory();
          }

          setupEventListeners() {
            // Enhanced backup buttons
            document.getElementById('backup-data')?.addEventListener('click', () => this.createFullBackup());
            document.getElementById('create-custom-backup')?.addEventListener('click', () => this.createCustomBackup());
            document.getElementById('save-backup-settings')?.addEventListener('click', () => this.saveBackupSettings());
            document.getElementById('refresh-backups')?.addEventListener('click', () => this.renderBackupHistory());
            document.getElementById('verify-backup')?.addEventListener('click', () => this.verifySelectedBackup());
            document.getElementById('emergency-restore')?.addEventListener('click', () => this.emergencyRestore());
          }

          createFullBackup() {
            try {
              const backupData = this.collectAllData();
              const backup = this.createBackupObject(backupData, 'full', 'Full System Backup');
              this.saveBackup(backup);
              this.downloadBackup(backup);
              this.showNotification('Full backup created successfully!', 'success');
            } catch (error) {
              this.showNotification('Failed to create backup: ' + error.message, 'error');
            }
          }

          createCustomBackup() {
            try {
              const backupName = document.getElementById('backup-name').value || 'Custom Backup';
              const backupType = document.getElementById('backup-type').value;
              const format = document.getElementById('backup-format').value;
              
              const backupData = this.collectDataByType(backupType);
              const backup = this.createBackupObject(backupData, backupType, backupName);
              this.saveBackup(backup);
              this.downloadBackup(backup, format);
              this.showNotification('Custom backup created successfully!', 'success');
            } catch (error) {
              this.showNotification('Failed to create custom backup: ' + error.message, 'error');
            }
          }

          collectAllData() {
            return {
            users: loadUsers(),
            lecturers: loadLecturers(),
            students: loadStudents(),
            courses: loadCourses(),
            sessions: loadAttendanceData(),
            settings: loadAdminSettings(),
              calendarEvents: this.getCalendarEvents(),
              metadata: {
                version: '1.0',
                systemInfo: this.getSystemInfo(),
                dataIntegrity: this.calculateDataIntegrity()
              }
            };
          }

          collectDataByType(type) {
            const data = { metadata: { version: '1.0', type, systemInfo: this.getSystemInfo() } };
            
            switch (type) {
              case 'users':
                data.users = loadUsers();
                break;
              case 'courses':
                data.courses = loadCourses();
                break;
              case 'attendance':
                data.sessions = loadAttendanceData();
                break;
              case 'settings':
                data.settings = loadAdminSettings();
                break;
              default:
                return this.collectAllData();
            }
            
            return data;
          }

          createBackupObject(data, type, name) {
            return {
              id: this.generateBackupId(),
              name: name,
              type: type,
              timestamp: new Date().toISOString(),
              data: data,
              checksum: this.calculateChecksum(data),
              size: JSON.stringify(data).length,
              version: '1.0'
            };
          }

          saveBackup(backup) {
            this.backupHistory.unshift(backup);
            this.backupHistory = this.backupHistory.slice(0, 50); // Keep only last 50 backups
            localStorage.setItem('backupHistory', JSON.stringify(this.backupHistory));
            this.renderBackupHistory();
          }

          downloadBackup(backup, format = 'json') {
            let content, mimeType, extension;
            
            switch (format) {
              case 'csv':
                content = this.convertToCSV(backup.data);
                mimeType = 'text/csv';
                extension = 'csv';
                break;
              case 'excel':
                content = this.convertToExcel(backup.data);
                mimeType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet';
                extension = 'xlsx';
                break;
              default:
                content = JSON.stringify(backup, null, 2);
                mimeType = 'application/json';
                extension = 'json';
            }
            
            const blob = new Blob([content], { type: mimeType });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
            a.download = `backup-${backup.name.replace(/[^a-zA-Z0-9]/g, '_')}-${backup.timestamp.slice(0,10)}.${extension}`;
          a.click();
          URL.revokeObjectURL(a.href);
        }

          renderBackupHistory() {
            const backupList = document.getElementById('backup-list');
            if (!backupList) return;
            
            if (this.backupHistory.length === 0) {
              backupList.innerHTML = '<div class="no-backups">No backups found. Create your first backup to get started.</div>';
              return;
            }
            
            backupList.innerHTML = this.backupHistory.map(backup => `
              <div class="backup-item" data-backup-id="${backup.id}">
                <div class="backup-info">
                  <div class="backup-name">${backup.name}</div>
                  <div class="backup-details">
                    <span class="backup-type">${backup.type}</span>
                    <span class="backup-date">${new Date(backup.timestamp).toLocaleString()}</span>
                    <span class="backup-size">${this.formatFileSize(backup.size)}</span>
                  </div>
                </div>
                <div class="backup-actions">
                  <button class="btn btn-small" onclick="backupManager.downloadBackup('${backup.id}')">Download</button>
                  <button class="btn btn-small" onclick="backupManager.restoreBackup('${backup.id}')">Restore</button>
                  <button class="btn btn-small btn-danger" onclick="backupManager.deleteBackup('${backup.id}')">Delete</button>
                </div>
              </div>
            `).join('');
          }

          restoreBackup(backupId) {
            const backup = this.backupHistory.find(b => b.id === backupId);
            if (!backup) {
              this.showNotification('Backup not found!', 'error');
              return;
            }
            
            const recoveryMode = document.getElementById('recovery-mode').value;
            const verifyEnabled = document.getElementById('recovery-verification').checked;
            
            if (verifyEnabled && !this.verifyBackupIntegrity(backup)) {
              this.showNotification('Backup verification failed! Cannot restore.', 'error');
              return;
            }
            
            if (confirm(`Are you sure you want to restore "${backup.name}"? This action cannot be undone.`)) {
              try {
                this.performRestore(backup, recoveryMode);
                this.showNotification('Backup restored successfully!', 'success');
                this.refreshAllData();
              } catch (error) {
                this.showNotification('Restore failed: ' + error.message, 'error');
              }
            }
          }

          performRestore(backup, mode) {
            const data = backup.data;
            
            switch (mode) {
              case 'replace':
                this.replaceAllData(data);
                break;
              case 'merge':
                this.mergeData(data);
                break;
              case 'selective':
                this.selectiveRestore(data);
                break;
            }
          }

          replaceAllData(data) {
              if (data.users) writeUsers(data.users);
              if (data.lecturers) writeLecturers(data.lecturers);
              if (data.students) writeStudents(data.students);
              if (data.courses) writeCourses(data.courses);
              if (data.sessions) localStorage.setItem('lecturerSessions', JSON.stringify(data.sessions));
              if (data.settings) saveAdminSettings(data.settings);
          }

          mergeData(data) {
            // Merge with existing data, avoiding duplicates
            if (data.users) {
              const existingUsers = loadUsers();
              const mergedUsers = this.mergeArrays(existingUsers, data.users, 'email');
              writeUsers(mergedUsers);
            }
            // Similar logic for other data types...
          }

          selectiveRestore(data) {
            // Show modal for selective restore
            this.showSelectiveRestoreModal(data);
          }

          verifyBackupIntegrity(backup) {
            const calculatedChecksum = this.calculateChecksum(backup.data);
            return calculatedChecksum === backup.checksum;
          }

          calculateChecksum(data) {
            const str = JSON.stringify(data);
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
              const char = str.charCodeAt(i);
              hash = ((hash << 5) - hash) + char;
              hash = hash & hash; // Convert to 32-bit integer
            }
            return hash.toString();
          }

          calculateDataIntegrity() {
            const data = this.collectAllData();
            return {
              totalRecords: this.countRecords(data),
              checksum: this.calculateChecksum(data),
              lastModified: new Date().toISOString()
            };
          }

          countRecords(data) {
            let count = 0;
            Object.values(data).forEach(item => {
              if (Array.isArray(item)) {
                count += item.length;
              } else if (typeof item === 'object' && item !== null) {
                count += this.countRecords(item);
              }
            });
            return count;
          }

          getSystemInfo() {
            return {
              userAgent: navigator.userAgent,
              timestamp: new Date().toISOString(),
              timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
              language: navigator.language
            };
          }

          getCalendarEvents() {
            try {
              return JSON.parse(localStorage.getItem('adminCalendarEvents') || '{}');
            } catch {
              return {};
            }
          }

          generateBackupId() {
            return 'backup_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          }

          formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
          }

          convertToCSV(data) {
            // Simple CSV conversion for tabular data
            const csvRows = [];
            if (data.users) {
              csvRows.push('Users');
              csvRows.push('Name,Email,Role');
              data.users.forEach(user => {
                csvRows.push(`${user.name},${user.email},${user.role}`);
              });
            }
            return csvRows.join('\n');
          }

          convertToExcel(data) {
            // Placeholder for Excel conversion
            return JSON.stringify(data, null, 2);
          }

          mergeArrays(existing, newData, key) {
            const existingMap = new Map(existing.map(item => [item[key], item]));
            newData.forEach(item => {
              if (!existingMap.has(item[key])) {
                existingMap.set(item[key], item);
              }
            });
            return Array.from(existingMap.values());
          }

          startAutoBackup() {
            if (!this.backupSettings.autoBackupEnabled) return;
            
            const now = new Date();
            const backupTime = new Date();
            const [hours, minutes] = this.backupSettings.backupTime.split(':');
            backupTime.setHours(parseInt(hours), parseInt(minutes), 0, 0);
            
            if (backupTime <= now) {
              backupTime.setDate(backupTime.getDate() + 1);
            }
            
            const timeUntilBackup = backupTime.getTime() - now.getTime();
            
            setTimeout(() => {
              this.performAutoBackup();
              this.startAutoBackup(); // Schedule next backup
            }, timeUntilBackup);
          }

          performAutoBackup() {
            try {
              const backupData = this.collectAllData();
              const backup = this.createBackupObject(backupData, 'full', `Auto Backup - ${new Date().toLocaleDateString()}`);
              this.saveBackup(backup);
              this.cleanupOldBackups();
              console.log('Auto backup completed successfully');
            } catch (error) {
              console.error('Auto backup failed:', error);
            }
          }

          cleanupOldBackups() {
            const retentionDays = this.backupSettings.retentionPeriod || 30;
            const cutoffDate = new Date();
            cutoffDate.setDate(cutoffDate.getDate() - retentionDays);
            
            this.backupHistory = this.backupHistory.filter(backup => {
              return new Date(backup.timestamp) > cutoffDate;
            });
            
            localStorage.setItem('backupHistory', JSON.stringify(this.backupHistory));
          }

          saveBackupSettings() {
            this.backupSettings = {
              autoBackupEnabled: document.getElementById('auto-backup-enabled').checked,
              backupFrequency: document.getElementById('backup-frequency').value,
              backupTime: document.getElementById('backup-time').value,
              retentionPeriod: parseInt(document.getElementById('backup-retention').value) || 30
            };
            
            localStorage.setItem('backupSettings', JSON.stringify(this.backupSettings));
            this.showNotification('Backup settings saved successfully!', 'success');
            
            if (this.backupSettings.autoBackupEnabled) {
              this.startAutoBackup();
            }
          }

          loadBackupSettings() {
            try {
              return JSON.parse(localStorage.getItem('backupSettings') || '{}');
            } catch {
              return {
                autoBackupEnabled: false,
                backupFrequency: 'daily',
                backupTime: '02:00',
                retentionPeriod: 30
              };
            }
          }

          loadBackupHistory() {
            try {
              return JSON.parse(localStorage.getItem('backupHistory') || '[]');
            } catch {
              return [];
            }
          }

          showNotification(message, type = 'info') {
            // Enhanced notification system
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
              position: fixed;
              top: 20px;
              right: 20px;
              padding: 15px 20px;
              border-radius: 8px;
              color: white;
              font-weight: 500;
              z-index: 10000;
              max-width: 400px;
              box-shadow: 0 4px 12px rgba(0,0,0,0.2);
              transform: translateX(100%);
              transition: all 0.3s ease;
              background: ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : '#3498db'};
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
              notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
              notification.style.transform = 'translateX(100%)';
              setTimeout(() => {
                if (notification.parentNode) {
                  notification.parentNode.removeChild(notification);
                }
              }, 300);
            }, 5000);
          }

          refreshAllData() {
            // Refresh all admin sections after restore
            if (typeof adminRenderUsers === 'function') adminRenderUsers();
            if (typeof adminRenderLecturers === 'function') adminRenderLecturers();
            if (typeof adminRenderStudents === 'function') adminRenderStudents();
            if (typeof updateDashboardStats === 'function') updateDashboardStats();
          }

          downloadBackup(backupId) {
            const backup = this.backupHistory.find(b => b.id === backupId);
            if (backup) {
              this.downloadBackup(backup);
            }
          }

          deleteBackup(backupId) {
            if (confirm('Are you sure you want to delete this backup? This action cannot be undone.')) {
              this.backupHistory = this.backupHistory.filter(b => b.id !== backupId);
              localStorage.setItem('backupHistory', JSON.stringify(this.backupHistory));
              this.renderBackupHistory();
              this.showNotification('Backup deleted successfully!', 'success');
            }
          }

          verifySelectedBackup() {
            const selectedBackup = this.backupHistory[0]; // Get most recent backup
            if (!selectedBackup) {
              this.showNotification('No backup selected for verification!', 'warning');
              return;
            }
            
            const isValid = this.verifyBackupIntegrity(selectedBackup);
            const message = isValid ? 'Backup verification successful!' : 'Backup verification failed!';
            const type = isValid ? 'success' : 'error';
            
            this.showNotification(message, type);
            
            // Show verification details
            this.showVerificationDetails(selectedBackup, isValid);
          }

          showVerificationDetails(backup, isValid) {
            const verificationDiv = document.createElement('div');
            verificationDiv.className = 'backup-verification';
            verificationDiv.innerHTML = `
              <h6>Backup Verification Results</h6>
              <div class="backup-verification-details">
                <div class="verification-item">
                  <span class="label">Status:</span>
                  <span class="value ${isValid ? 'success' : 'error'}">${isValid ? 'Valid' : 'Invalid'}</span>
                </div>
                <div class="verification-item">
                  <span class="label">Backup Name:</span>
                  <span class="value">${backup.name}</span>
                </div>
                <div class="verification-item">
                  <span class="label">Created:</span>
                  <span class="value">${new Date(backup.timestamp).toLocaleString()}</span>
                </div>
                <div class="verification-item">
                  <span class="label">Size:</span>
                  <span class="value">${this.formatFileSize(backup.size)}</span>
                </div>
                <div class="verification-item">
                  <span class="label">Checksum:</span>
                  <span class="value">${backup.checksum}</span>
                </div>
                <div class="verification-item">
                  <span class="label">Records:</span>
                  <span class="value">${this.countRecords(backup.data)}</span>
                </div>
              </div>
            `;
            
            // Remove existing verification if any
            const existing = document.querySelector('.backup-verification');
            if (existing) existing.remove();
            
            // Add to backup history container
            const container = document.querySelector('.backup-history-container');
            if (container) {
              container.appendChild(verificationDiv);
              
              // Auto-remove after 10 seconds
              setTimeout(() => {
                if (verificationDiv.parentNode) {
                  verificationDiv.parentNode.removeChild(verificationDiv);
                }
              }, 10000);
            }
          }

          emergencyRestore() {
            this.showEmergencyRestoreModal();
          }

          showEmergencyRestoreModal() {
            const modal = document.createElement('div');
            modal.className = 'emergency-modal active';
            modal.innerHTML = `
              <div class="emergency-modal-content">
                <h3>‚ö†Ô∏è Emergency Restore</h3>
                <p>This will restore the most recent backup and replace ALL current data. This action cannot be undone.</p>
                <p><strong>Are you absolutely sure you want to proceed?</strong></p>
                <div class="emergency-modal-actions">
                  <button class="btn" onclick="this.closest('.emergency-modal').remove()">Cancel</button>
                  <button class="btn btn-danger" onclick="backupManager.performEmergencyRestore()">Proceed with Emergency Restore</button>
                </div>
              </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close on backdrop click
            modal.addEventListener('click', (e) => {
              if (e.target === modal) {
                modal.remove();
              }
            });
          }

          performEmergencyRestore() {
            const latestBackup = this.backupHistory[0];
            if (!latestBackup) {
              this.showNotification('No backup available for emergency restore!', 'error');
              return;
            }
            
            try {
              this.replaceAllData(latestBackup.data);
              this.showNotification('Emergency restore completed successfully!', 'success');
              this.refreshAllData();
              
              // Close modal
              const modal = document.querySelector('.emergency-modal');
              if (modal) modal.remove();
            } catch (error) {
              this.showNotification('Emergency restore failed: ' + error.message, 'error');
            }
          }

          showSelectiveRestoreModal(data) {
            const modal = document.createElement('div');
            modal.className = 'emergency-modal active';
            modal.innerHTML = `
              <div class="emergency-modal-content" style="max-width: 600px;">
                <h3>Selective Restore</h3>
                <p>Choose which data types to restore from the backup:</p>
                <div class="selective-restore-options">
                  ${Object.keys(data).filter(key => key !== 'metadata').map(key => `
                    <label class="checkbox-item">
                      <input type="checkbox" value="${key}" checked>
                      <span class="checkmark"></span>
                      <span>${key.charAt(0).toUpperCase() + key.slice(1)} (${Array.isArray(data[key]) ? data[key].length : 'N/A'} records)</span>
                    </label>
                  `).join('')}
                </div>
                <div class="emergency-modal-actions">
                  <button class="btn" onclick="this.closest('.emergency-modal').remove()">Cancel</button>
                  <button class="btn" onclick="backupManager.performSelectiveRestore(this.closest('.emergency-modal'))">Restore Selected</button>
                </div>
              </div>
            `;
            
            document.body.appendChild(modal);
          }

          performSelectiveRestore(modal) {
            const checkboxes = modal.querySelectorAll('input[type="checkbox"]:checked');
            const selectedTypes = Array.from(checkboxes).map(cb => cb.value);
            
            if (selectedTypes.length === 0) {
              this.showNotification('Please select at least one data type to restore!', 'warning');
              return;
            }
            
            // Get the backup data (this would need to be passed to the modal)
            const backup = this.backupHistory[0]; // For now, use latest backup
            if (!backup) {
              this.showNotification('No backup data available!', 'error');
              return;
            }
            
            try {
              selectedTypes.forEach(type => {
                if (backup.data[type]) {
                  switch (type) {
                    case 'users':
                      writeUsers(backup.data[type]);
                      break;
                    case 'lecturers':
                      writeLecturers(backup.data[type]);
                      break;
                    case 'students':
                      writeStudents(backup.data[type]);
                      break;
                    case 'courses':
                      writeCourses(backup.data[type]);
                      break;
                    case 'sessions':
                      localStorage.setItem('lecturerSessions', JSON.stringify(backup.data[type]));
                      break;
                    case 'settings':
                      saveAdminSettings(backup.data[type]);
                      break;
                  }
                }
              });
              
              this.showNotification(`Selective restore completed for: ${selectedTypes.join(', ')}`, 'success');
              this.refreshAllData();
              modal.remove();
            } catch (error) {
              this.showNotification('Selective restore failed: ' + error.message, 'error');
            }
          }
        }

        // Enhanced Data Validation & Error Handling System
        class ValidationManager {
          constructor() {
            this.validationRules = this.initializeValidationRules();
            this.errorMessages = this.initializeErrorMessages();
            this.setupGlobalErrorHandling();
          }

          initializeValidationRules() {
            return {
              email: {
                pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
                required: true,
                minLength: 5,
                maxLength: 100
              },
              password: {
                pattern: /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,
                required: true,
                minLength: 8,
                maxLength: 50
              },
              name: {
                pattern: /^[a-zA-Z\s'-]+$/,
                required: true,
                minLength: 2,
                maxLength: 50
              },
              phone: {
                pattern: /^[\+]?[1-9][\d]{0,15}$/,
                required: false,
                minLength: 10,
                maxLength: 15
              },
              studentId: {
                pattern: /^[A-Za-z0-9]+$/,
                required: true,
                minLength: 3,
                maxLength: 20
              },
              courseCode: {
                pattern: /^[A-Z]{2,4}[0-9]{3,4}$/,
                required: true,
                minLength: 5,
                maxLength: 8
              },
              courseName: {
                pattern: /^[a-zA-Z0-9\s\-&.,()]+$/,
                required: true,
                minLength: 3,
                maxLength: 100
              },
              sessionName: {
                pattern: /^[a-zA-Z0-9\s\-&.,()]+$/,
                required: true,
                minLength: 3,
                maxLength: 100
              },
              qrCode: {
                pattern: /^[A-Za-z0-9\-_]+$/,
                required: true,
                minLength: 10,
                maxLength: 50
              }
            };
          }

          initializeErrorMessages() {
            return {
              required: 'This field is required',
              email: 'Please enter a valid email address',
              password: 'Password must be at least 8 characters with uppercase, lowercase, number, and special character',
              name: 'Name can only contain letters, spaces, hyphens, and apostrophes',
              phone: 'Please enter a valid phone number',
              studentId: 'Student ID can only contain letters and numbers',
              courseCode: 'Course code must be 2-4 letters followed by 3-4 numbers (e.g., CS101)',
              courseName: 'Course name contains invalid characters',
              sessionName: 'Session name contains invalid characters',
              qrCode: 'QR code can only contain letters, numbers, hyphens, and underscores',
              minLength: (min) => `Must be at least ${min} characters long`,
              maxLength: (max) => `Must be no more than ${max} characters long`,
              duplicate: 'This value already exists',
              futureDate: 'Date must be in the future',
              pastDate: 'Date must be in the past',
              invalidDate: 'Please enter a valid date',
              invalidTime: 'Please enter a valid time',
              invalidNumber: 'Please enter a valid number',
              positiveNumber: 'Please enter a positive number',
              range: (min, max) => `Value must be between ${min} and ${max}`
            };
          }

          setupGlobalErrorHandling() {
            // Global error handler for unhandled errors
            window.addEventListener('error', (event) => {
              this.handleGlobalError(event.error);
            });

            // Global handler for unhandled promise rejections
            window.addEventListener('unhandledrejection', (event) => {
              this.handleGlobalError(event.reason);
            });
          }

          validateField(fieldName, value, customRules = {}) {
            const rules = { ...this.validationRules[fieldName], ...customRules };
            const errors = [];

            // Required validation
            if (rules.required && (!value || value.trim() === '')) {
              errors.push(this.errorMessages.required);
              return { isValid: false, errors };
            }

            // Skip other validations if field is empty and not required
            if (!value || value.trim() === '') {
              return { isValid: true, errors: [] };
            }

            // Length validation
            if (rules.minLength && value.length < rules.minLength) {
              errors.push(this.errorMessages.minLength(rules.minLength));
            }
            if (rules.maxLength && value.length > rules.maxLength) {
              errors.push(this.errorMessages.maxLength(rules.maxLength));
            }

            // Pattern validation
            if (rules.pattern && !rules.pattern.test(value)) {
              errors.push(this.errorMessages[fieldName] || 'Invalid format');
            }

            // Custom validation functions
            if (rules.custom && typeof rules.custom === 'function') {
              const customResult = rules.custom(value);
              if (customResult !== true) {
                errors.push(customResult);
              }
            }

            return { isValid: errors.length === 0, errors };
          }

          validateForm(formData, formType) {
            const errors = {};
            let isValid = true;

            // Define form-specific validation rules
            const formRules = this.getFormRules(formType);

            for (const [fieldName, value] of Object.entries(formData)) {
              const fieldRules = formRules[fieldName];
              if (fieldRules) {
                const validation = this.validateField(fieldName, value, fieldRules);
                if (!validation.isValid) {
                  errors[fieldName] = validation.errors;
                  isValid = false;
                }
              }
            }

            // Cross-field validation
            const crossFieldErrors = this.validateCrossFields(formData, formType);
            Object.assign(errors, crossFieldErrors);
            if (Object.keys(crossFieldErrors).length > 0) {
              isValid = false;
            }

            return { isValid, errors };
          }

          getFormRules(formType) {
            const baseRules = {
              user: {
                name: this.validationRules.name,
                email: this.validationRules.email,
                password: this.validationRules.password,
                role: { required: true }
              },
              lecturer: {
                name: this.validationRules.name,
                email: this.validationRules.email,
                password: this.validationRules.password,
                phone: this.validationRules.phone,
                department: { required: true, minLength: 2, maxLength: 50 }
              },
              student: {
                name: this.validationRules.name,
                email: this.validationRules.email,
                studentId: this.validationRules.studentId,
                phone: this.validationRules.phone,
                course: { required: true }
              },
              course: {
                code: this.validationRules.courseCode,
                name: this.validationRules.courseName,
                credits: { required: true, min: 1, max: 6, type: 'number' },
                department: { required: true, minLength: 2, maxLength: 50 }
              },
              session: {
                name: this.validationRules.sessionName,
                course: { required: true },
                date: { required: true, type: 'date', future: true },
                startTime: { required: true, type: 'time' },
                endTime: { required: true, type: 'time' },
                qrCode: this.validationRules.qrCode
              }
            };

            return baseRules[formType] || {};
          }

          validateCrossFields(formData, formType) {
            const errors = {};

            switch (formType) {
              case 'session':
                // Validate that end time is after start time
                if (formData.startTime && formData.endTime) {
                  const startTime = new Date(`2000-01-01T${formData.startTime}`);
                  const endTime = new Date(`2000-01-01T${formData.endTime}`);
                  if (endTime <= startTime) {
                    errors.endTime = ['End time must be after start time'];
                  }
                }
                break;

              case 'user':
              case 'lecturer':
              case 'student':
                // Check for duplicate emails
                if (formData.email) {
                  const existingUsers = loadUsers();
                  const existingLecturers = loadLecturers();
                  const existingStudents = loadStudents();
                  
                  const allEmails = [
                    ...existingUsers.map(u => u.email),
                    ...existingLecturers.map(l => l.email),
                    ...existingStudents.map(s => s.email)
                  ];

                  if (allEmails.includes(formData.email)) {
                    errors.email = ['This email address is already in use'];
                  }
                }
                break;

              case 'student':
                // Check for duplicate student ID
                if (formData.studentId) {
                  const existingStudents = loadStudents();
                  if (existingStudents.some(s => s.studentId === formData.studentId)) {
                    errors.studentId = ['This student ID is already in use'];
                  }
                }
                break;

              case 'course':
                // Check for duplicate course code
                if (formData.code) {
                  const existingCourses = loadCourses();
                  if (existingCourses.some(c => c.code === formData.code)) {
                    errors.code = ['This course code is already in use'];
                  }
                }
                break;
            }

            return errors;
          }

          showFieldError(fieldElement, errors) {
            // Remove existing error styling
            this.clearFieldError(fieldElement);

            if (errors && errors.length > 0) {
              fieldElement.classList.add('error');
              
              // Create error message element
              const errorElement = document.createElement('div');
              errorElement.className = 'field-error';
              errorElement.innerHTML = errors.map(error => `<span class="error-message">${error}</span>`).join('<br>');
              
              // Insert after the field
              fieldElement.parentNode.insertBefore(errorElement, fieldElement.nextSibling);
            }
          }

          clearFieldError(fieldElement) {
            fieldElement.classList.remove('error');
            const existingError = fieldElement.parentNode.querySelector('.field-error');
            if (existingError) {
              existingError.remove();
            }
          }

          showFormErrors(errors) {
            // Clear all existing errors
            document.querySelectorAll('.field-error').forEach(error => error.remove());
            document.querySelectorAll('.error').forEach(field => field.classList.remove('error'));

            // Show new errors
            for (const [fieldName, fieldErrors] of Object.entries(errors)) {
              const fieldElement = document.querySelector(`[name="${fieldName}"], #${fieldName}`);
              if (fieldElement) {
                this.showFieldError(fieldElement, fieldErrors);
              }
            }
          }

          handleGlobalError(error) {
            console.error('Global error caught:', error);
            
            // Show user-friendly error message
            this.showNotification(
              'An unexpected error occurred. Please try again or contact support if the problem persists.',
              'error'
            );

            // Log error details for debugging
            this.logError(error);
          }

          logError(error) {
            const errorLog = {
              timestamp: new Date().toISOString(),
              message: error.message || 'Unknown error',
              stack: error.stack || 'No stack trace available',
              userAgent: navigator.userAgent,
              url: window.location.href
            };

            // Store error log in localStorage for debugging
            try {
              const existingLogs = JSON.parse(localStorage.getItem('errorLogs') || '[]');
              existingLogs.unshift(errorLog);
              existingLogs.splice(50); // Keep only last 50 errors
              localStorage.setItem('errorLogs', JSON.stringify(existingLogs));
            } catch (e) {
              console.error('Failed to log error:', e);
            }
          }

          showNotification(message, type = 'info', duration = 5000) {
            // Enhanced notification system with better styling
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
              position: fixed;
              top: 20px;
              right: 20px;
              padding: 16px 20px;
              border-radius: 8px;
              color: white;
              font-weight: 500;
              z-index: 10000;
              max-width: 400px;
              box-shadow: 0 4px 12px rgba(0,0,0,0.2);
              transform: translateX(100%);
              transition: all 0.3s ease;
              backdrop-filter: blur(10px);
              border-left: 4px solid ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : type === 'warning' ? '#f39c12' : '#3498db'};
            `;
            
            // Add icon based on type
            const icons = {
              success: '‚úì',
              error: '‚úó',
              warning: '‚ö†',
              info: '‚Ñπ'
            };
            
            notification.innerHTML = `
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-size: 18px;">${icons[type] || '‚Ñπ'}</span>
                <span>${message}</span>
              </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
              notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
              notification.style.transform = 'translateX(100%)';
              setTimeout(() => {
                if (notification.parentNode) {
                  notification.parentNode.removeChild(notification);
                }
              }, 300);
            }, duration);
          }

          // Real-time validation for form fields
          setupRealTimeValidation(formElement) {
            const inputs = formElement.querySelectorAll('input, select, textarea');
            
            inputs.forEach(input => {
              // Validate on blur
              input.addEventListener('blur', () => {
                const fieldName = input.name || input.id;
                const validation = this.validateField(fieldName, input.value);
                this.showFieldError(input, validation.errors);
              });

              // Clear errors on focus
              input.addEventListener('focus', () => {
                this.clearFieldError(input);
              });

              // Real-time validation for specific field types
              if (input.type === 'email') {
                input.addEventListener('input', () => {
                  if (input.value.length > 0) {
                    const validation = this.validateField('email', input.value);
                    this.showFieldError(input, validation.errors);
                  }
                });
              }
            });
          }

          // Validate and sanitize input data
          sanitizeInput(input) {
            if (typeof input === 'string') {
              return input.trim().replace(/[<>]/g, '');
            }
            return input;
          }

          // Validate file uploads
          validateFile(file, allowedTypes = [], maxSize = 5 * 1024 * 1024) {
            const errors = [];

            if (!file) {
              errors.push('No file selected');
              return { isValid: false, errors };
            }

            if (allowedTypes.length > 0 && !allowedTypes.includes(file.type)) {
              errors.push(`File type not allowed. Allowed types: ${allowedTypes.join(', ')}`);
            }

            if (file.size > maxSize) {
              errors.push(`File too large. Maximum size: ${this.formatFileSize(maxSize)}`);
            }

            return { isValid: errors.length === 0, errors };
          }

          formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
          }
        }

        // Initialize validation manager
        const validationManager = new ValidationManager();

        // Initialize backup manager
        const backupManager = new BackupManager();

        // Load backup settings on page load
        document.addEventListener('DOMContentLoaded', function() {
          // Load backup settings into form fields
          const settings = backupManager.loadBackupSettings();
          if (settings.autoBackupEnabled !== undefined) {
            document.getElementById('auto-backup-enabled').checked = settings.autoBackupEnabled;
          }
          if (settings.backupFrequency) {
            document.getElementById('backup-frequency').value = settings.backupFrequency;
          }
          if (settings.backupTime) {
            document.getElementById('backup-time').value = settings.backupTime;
          }
          if (settings.retentionPeriod) {
            document.getElementById('backup-retention').value = settings.retentionPeriod;
          }

          // Setup real-time validation for all forms
          setupFormValidation();
        });

        function setupFormValidation() {
          // Setup validation for user form
          const userForm = document.querySelector('#user-form, .user-form');
          if (userForm) {
            validationManager.setupRealTimeValidation(userForm);
          }

          // Setup validation for lecturer form
          const lecturerForm = document.querySelector('#lecturer-form, .lecturer-form');
          if (lecturerForm) {
            validationManager.setupRealTimeValidation(lecturerForm);
          }

          // Setup validation for student form
          const studentForm = document.querySelector('#student-form, .student-form');
          if (studentForm) {
            validationManager.setupRealTimeValidation(studentForm);
          }

          // Setup validation for course form
          const courseForm = document.querySelector('#course-form, .course-form');
          if (courseForm) {
            validationManager.setupRealTimeValidation(courseForm);
          }

          // Setup validation for session form
          const sessionForm = document.querySelector('#session-form, .session-form');
          if (sessionForm) {
            validationManager.setupRealTimeValidation(sessionForm);
          }

          // Add password strength indicator
          setupPasswordStrengthIndicator();
        }

        function setupPasswordStrengthIndicator() {
          const passwordFields = document.querySelectorAll('input[type="password"]');
          
          passwordFields.forEach(field => {
            const container = field.closest('.form-field');
            if (!container) return;

            // Create password strength indicator
            const strengthIndicator = document.createElement('div');
            strengthIndicator.className = 'password-strength';
            strengthIndicator.innerHTML = '<div class="password-strength-bar"></div>';
            
            // Insert after the field
            field.parentNode.insertBefore(strengthIndicator, field.nextSibling);

            // Add event listener for password strength checking
            field.addEventListener('input', () => {
              const strength = calculatePasswordStrength(field.value);
              updatePasswordStrengthIndicator(strengthIndicator, strength);
            });
          });
        }

        function calculatePasswordStrength(password) {
          let score = 0;
          let feedback = [];

          if (password.length >= 8) score += 1;
          else feedback.push('At least 8 characters');

          if (/[a-z]/.test(password)) score += 1;
          else feedback.push('Lowercase letter');

          if (/[A-Z]/.test(password)) score += 1;
          else feedback.push('Uppercase letter');

          if (/[0-9]/.test(password)) score += 1;
          else feedback.push('Number');

          if (/[^A-Za-z0-9]/.test(password)) score += 1;
          else feedback.push('Special character');

          const levels = ['weak', 'fair', 'good', 'strong'];
          const level = levels[Math.min(score - 1, 3)] || 'weak';

          return { score, level, feedback };
        }

        function updatePasswordStrengthIndicator(indicator, strength) {
          indicator.className = `password-strength ${strength.level}`;
          
          // Update the bar width
          const bar = indicator.querySelector('.password-strength-bar');
          const width = (strength.score / 5) * 100;
          bar.style.width = `${width}%`;
        }

        function backupAllData(){
          backupManager.createFullBackup();
        }

        function restoreData(file){
          const reader = new FileReader();
          reader.onload = () => {
            try {
              const backupData = JSON.parse(String(reader.result||'{}'));
              
              // Check if it's a new backup format or legacy format
              if (backupData.data && backupData.metadata) {
                // New backup format
                const recoveryMode = document.getElementById('recovery-mode').value;
                const verifyEnabled = document.getElementById('recovery-verification').checked;
                
                if (verifyEnabled && !backupManager.verifyBackupIntegrity(backupData)) {
                  backupManager.showNotification('Backup verification failed! Cannot restore.', 'error');
                  return;
                }
                
                backupManager.performRestore(backupData, recoveryMode);
                backupManager.showNotification('Data restored successfully!', 'success');
                backupManager.refreshAllData();
              } else {
                // Legacy format - direct restore
                if (backupData.users) writeUsers(backupData.users);
                if (backupData.lecturers) writeLecturers(backupData.lecturers);
                if (backupData.students) writeStudents(backupData.students);
                if (backupData.courses) writeCourses(backupData.courses);
                if (backupData.sessions) localStorage.setItem('lecturerSessions', JSON.stringify(backupData.sessions));
                if (backupData.settings) saveAdminSettings(backupData.settings);
                
                backupManager.showNotification('Legacy backup restored successfully!', 'success');
                backupManager.refreshAllData();
              }
            } catch (e) {
              backupManager.showNotification('Error restoring data: ' + e.message, 'error');
            }
          };
          reader.readAsText(file);
        }

        function clearAllData(){
          if (confirm('This will permanently delete ALL data. Are you sure?')){
            localStorage.clear();
            alert('All data cleared!');
          }
        }

        function exportAllData(){
          const data = {
            users: loadUsers(),
            lecturers: loadLecturers(),
            students: loadStudents(),
            courses: loadCourses(),
            sessions: loadAttendanceData(),
            settings: loadAdminSettings(),
            exportDate: new Date().toISOString()
          };
          const blob = new Blob([JSON.stringify(data,null,2)], { type: 'application/json' });
          const a = document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download = `admin-export-${new Date().toISOString().slice(0,10)}.json`;
          a.click();
          URL.revokeObjectURL(a.href);
        }

        // Event listeners
        attFilterApply?.addEventListener('click', adminRenderAttendance);
        attExportBtn?.addEventListener('click', exportAttendanceReport);
        generateReportBtn?.addEventListener('click', generateReport);
        saveSettingsBtn?.addEventListener('click', saveSettings);
        resetSettingsBtn?.addEventListener('click', resetSettings);
        timezoneSelect?.addEventListener('change', handleTimezoneChange);
        backupDataBtn?.addEventListener('click', backupAllData);
        restoreDataBtn?.addEventListener('click', () => restoreFile?.click());
        restoreFile?.addEventListener('change', (e) => { const f = e.target.files?.[0]; if (f) restoreData(f); e.target.value = ''; });
        clearAllDataBtn?.addEventListener('click', clearAllData);
        exportAllBtn?.addEventListener('click', exportAllData);

        // Initialize sections if visible
        if (document.getElementById('attendance')?.style.display === 'block') {
          populateAttendanceFilters();
          adminRenderAttendance();
        }
        if (document.getElementById('settings')?.style.display === 'block') {
          adminLoadSettings();
          initializeTimezone();
        }

        // ===== Dashboard Stats Update =====
        function updateDashboardStats(){
          const users = loadUsers();
          const lecturers = loadLecturers();
          const students = loadStudents();
          const courses = loadCourses();
          const sessions = loadAttendanceData();
          
          // Update dashboard stats
          const statsSpans = document.querySelectorAll('.stats-grid .stat-box span');
          if (statsSpans.length >= 4) {
            statsSpans[0].textContent = students.length;
            statsSpans[1].textContent = lecturers.length;
            statsSpans[2].textContent = courses.length;
            statsSpans[3].textContent = sessions.length;
          }
        }

        // Initialize sample data if none exists
        function initializeSampleData(){
          if (localStorage.getItem('users') === null) {
            const sampleUsers = [
              { name: 'Kamva Mchwayi', email: 'kamva@example.com', password: 'admin123', role: 'Admin' },
              { name: 'Nyaniso Sikoko', email: 'nyaniso@example.com', password: 'admin123', role: 'Admin' },
              { name: 'Siyabonga Sithole', email: 'siyabonga@example.com', password: 'admin123', role: 'Admin' },
              { name: 'Dr. Soetsang', email: 'soetsang@example.com', password: 'lecturer123', role: 'Lecturer' },
              { name: 'Prof. Mathabathe', email: 'mathabathe@example.com', password: 'lecturer123', role: 'Lecturer' },
              { name: 'Dr. Kaleni', email: 'kaleni@example.com', password: 'lecturer123', role: 'Lecturer' },
              { name: 'Bukho Skweza', email: 'bukho@example.com', password: 'student1', role: 'Student' },
              { name: 'Ramphadi Rebone', email: 'ramphadi@example.com', password: 'student12', role: 'Student' },
              { name: 'Zinhle Dlamini', email: 'zinhle@example.com', password: 'student123', role: 'Student' }
            ];
            localStorage.setItem('users', JSON.stringify(sampleUsers));
          }
          
          if (localStorage.getItem('lecturers') === null) {
            const sampleLecturers = [
              { name: 'Dr. Soetsang', email: 'soetsang@example.com', password: 'lecturer123', department: 'Application Development', office: 'Block A, Room 101', phone: '+27 82 123 4567', bio: 'Senior Lecturer in Application Development' },
              { name: 'Prof. Mathabathe', email: 'mathabathe@example.com', password: 'lecturer123', department: 'Information Technology', office: 'Block B, Room 205', phone: '+27 83 234 5678', bio: 'Professor in Information Technology' },
              { name: 'Dr. Kaleni', email: 'kaleni@example.com', password: 'lecturer123', department: 'Engineering', office: 'Block C, Room 310', phone: '+27 84 345 6789', bio: 'Senior Lecturer in Engineering' }
            ];
            localStorage.setItem('lecturers', JSON.stringify(sampleLecturers));
          }
          
          if (localStorage.getItem('students') === null) {
            const sampleStudents = [
              { name: 'Bukho Skweza', email: 'bukho@example.com', password: 'student1', year: '2', course: 'HCI-2', studentId: '231031149' },
              { name: 'Ramphadi Rebone', email: 'ramphadi@example.com', password: 'student12', year: '2', course: 'DES-2', studentId: '231066538' },
              { name: 'Zinhle Dlamini', email: 'zinhle@example.com', password: 'student123', year: '2', course: 'TEP-1', studentId: '230343775' }
            ];
            localStorage.setItem('students', JSON.stringify(sampleStudents));
          }
          
          if (localStorage.getItem('courses') === null) {
            const sampleCourses = [
              { code: 'HCI-2', name: 'Human Computer Interaction', lecturer: 'soetsang@example.com', description: 'Introduction to HCI principles' },
              { code: 'DES-2', name: 'Development Software', lecturer: 'mathabathe@example.com', description: 'Software development methodologies' },
              { code: 'TEP-1', name: 'Technical Programming', lecturer: 'kaleni@example.com', description: 'Advanced programming techniques' },
              { code: 'INF-2', name: 'Information Systems', lecturer: 'soetsang@example.com', description: 'Information systems design' }
            ];
            localStorage.setItem('courses', JSON.stringify(sampleCourses));
          }
        }

        // Initialize the system
        initializeSampleData();
        updateDashboardStats();
        
        // Initialize calendar on page load
        setTimeout(() => {
            try {
                // Test calendar elements
                console.log('Testing calendar elements...');
                console.log('admMonthName:', admMonthName);
                console.log('admWeekdaysEl:', admWeekdaysEl);
                console.log('admDaysEl:', admDaysEl);
                console.log('admCalendarCursor:', admCalendarCursor);
                
                adminRenderCalendar();
                console.log('Admin calendar initialized successfully');
            } catch (error) {
                console.error('Admin calendar initialization failed:', error);
            }
        }, 100);

        // Mobile sidebar functionality
        document.getElementById('sidebar-toggle').addEventListener('click', function() {
          const sidebar = document.getElementById('sidebar2');
          sidebar.classList.add('active');
          document.body.style.overflow = 'hidden'; // Prevent background scrolling
        });
        
        document.getElementById('sidebar-close').addEventListener('click', function() {
          const sidebar = document.getElementById('sidebar2');
          sidebar.classList.remove('active');
          document.body.style.overflow = ''; // Restore scrolling
        });
        
        // Close sidebar when clicking outside
        document.getElementById('sidebar2').addEventListener('click', function(e) {
          if (e.target === this) {
            this.classList.remove('active');
            document.body.style.overflow = '';
          }
        });
        
        // Close sidebar on escape key
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            const sidebar = document.getElementById('sidebar2');
            if (sidebar.classList.contains('active')) {
              sidebar.classList.remove('active');
              document.body.style.overflow = '';
            }
          }
        });

      });
    </script>
  </body>
</html>
        